var objMRFApprovalListJS;const MRFApprovalListURL="/Manpower/MRFApproval?handler=List",PositionLevelAutoCompleteURL="/Manpower/MRFApproval?handler=PositionLevelAutoComplete",OrgGroupAutoCompleteURL="/Manpower/MRFApproval?handler=OrgTypeAutoComplete",PositionAutoCompleteURL="/Manpower/MRFApproval?handler=PositionAutoComplete",GetNatureOfEmploymentURL="/Manpower/MRFApproval?handler=ReferenceValue&RefCode=NATURE_OF_EMPLOYMENT",GetStatusURL="/Manpower/MRFApproval?handler=ReferenceValue&RefCode=MRF_APPROVER_STATUS",GetPositionLevelDropDownByOrgGroupIDURL="/Manpower/MRFApproval/Edit?handler=PositionLevelDropDownByOrgGroupID",GetPositionDropDownURL="/Manpower/MRFApproval/Edit?handler=PositionDropDown",GetSignatoriesURL="/Manpower/MRFApproval/Edit?handler=Signatories",GetRegionByIDURL="/Manpower/MRFApproval/Edit?handler=RegionByID",GetApprovalHistoryURL="/Manpower/MRFApproval?handler=MRFApprovalHistory",MRFApprovalEditURL="/ManPower/MRFApproval/Edit",MRFApprovalEditPostURL="/ManPower/MRFApproval/Edit?handler=Submit",GetCommentsURL="/Manpower/MRFApproval/Edit?handler=MRFComments",SaveCommentsURL="/Manpower/MRFApproval/Edit?handler=SaveComments";$(document).ready(function(){objMRFApprovalListJS={Initialize:function(){var n=this,t;$("#txtFilterDateCreatedFrom, #txtFilterDateCreatedTo, #txtFilterDateApprovedFrom, #txtFilterDateApprovedTo").datetimepicker({useCurrent:!1,format:"MM/DD/YYYY"});n.ElementBinding();t={ID:localStorage.ManpowerMRFApprovalListID,MRFTransactionID:localStorage.ManpowerMRFApprovalListMRFTransactionID,OrgGroupDelimited:localStorage.ManpowerMRFApprovalListOrgGroupDelimited,PositionLevelDelimited:localStorage.ManpowerMRFApprovalListPositionLevelDelimited,PositionDelimited:localStorage.ManpowerMRFApprovalListPositionDelimited,NatureOfEmploymentDelimited:localStorage.ManpowerMRFApprovalListNatureOfEmploymentDelimited,NoOfApplicantMin:localStorage.ManpowerMRFApprovalListNoOfApplicantMin,NoOfApplicantMax:localStorage.ManpowerMRFApprovalListNoOfApplicantMax,StatusDelimited:localStorage.ManpowerMRFApprovalListStatusDelimited,DateCreatedFrom:localStorage.ManpowerMRFApprovalListDateCreatedFrom,DateCreatedTo:localStorage.ManpowerMRFApprovalListDateCreatedTo,DateApprovedFrom:localStorage.ManpowerMRFApprovalListDateApprovedFrom,DateApprovedTo:localStorage.ManpowerMRFApprovalListDateApprovedTo,AgeMin:localStorage.ManpowerMRFApprovalListAgeMin,AgeMax:localStorage.ManpowerMRFApprovalListAgeMax};n.LoadJQGrid(t);n.GetLocalStorage()},ElementBinding:function(){var n=this;NumberOnly($("#txtFilterMRFID"));$("#btnSearch").click(function(){var t={ID:$("#txtFilterMRFID").val(),MRFTransactionID:$("#txtFilterMRFTransactionID").val(),OrgGroupDelimited:objEMSCommonJS.GetMultiSelectList("multiSelectedOrgGroup").value,PositionLevelDelimited:objEMSCommonJS.GetMultiSelectList("multiSelectedPositionLevel").value,PositionDelimited:objEMSCommonJS.GetMultiSelectList("multiSelectedPosition").value,NatureOfEmploymentDelimited:objEMSCommonJS.GetMultiSelectList("multiSelectedNatureOfEmployment").value,NoOfApplicantMin:$("#txtFilterNoOfApplicantMin").val(),NoOfApplicantMax:$("#txtFilterNoOfApplicantMax").val(),StatusDelimited:objEMSCommonJS.GetMultiSelectList("multiSelectedStatus").value,DateCreatedFrom:$("#txtFilterDateCreatedFrom").val(),DateCreatedTo:$("#txtFilterDateCreatedTo").val(),DateApprovedFrom:$("#txtFilterDateApprovedFrom").val(),DateApprovedTo:$("#txtFilterDateApprovedTo").val(),AgeMin:$("#txtFilterAgeMin").val(),AgeMax:$("#txtFilterAgeMax").val()};n.SetLocalStorage();ResetJQGridState("tblManpowerMRFApprovalList");n.LoadJQGrid(t)});$("#btnReset").click(function(){$("div.filterFields input[type='search']").val("");$("div.filterFields select").val("");$("div.filterFields input[type='checkbox']").prop("checked",!0);$("#multiSelectedOrgGroup").html("");$("#multiSelectedPositionLevel").html("");$("#multiSelectedPosition").html("");$("#multiSelectedNatureOfEmployment").html("");$("#multiSelectedNatureOfEmploymentOption label, #multiSelectedNatureOfEmploymentOption input").prop("title","add");$("#multiSelectedStatus").html("");$("#multiSelectedStatusOption label, #multiSelectedStatusOption input").prop("title","add");$("#btnSearch").click()});objEMSCommonJS.BindFilterMultiSelectAutoComplete("txtFilterOrgGroup",OrgGroupAutoCompleteURL,20,"multiSelectedOrgGroup");objEMSCommonJS.BindFilterMultiSelectAutoComplete("txtFilterPositionLevel",PositionLevelAutoCompleteURL,20,"multiSelectedPositionLevel");objEMSCommonJS.BindFilterMultiSelectAutoComplete("txtFilterPosition",PositionAutoCompleteURL,20,"multiSelectedPosition");objEMSCommonJS.BindFilterMultiSelectEnum("multiSelectedNatureOfEmployment",GetNatureOfEmploymentURL);objEMSCommonJS.BindFilterMultiSelectEnum("multiSelectedStatus",GetStatusURL)},LoadJQGrid:function(n){var r=this,t,i;Loading(!0);t=localStorage.getItem("tblManpowerMRFApprovalList")==""?"":$.parseJSON(localStorage.getItem("tblManpowerMRFApprovalList"));i=function(){var n=$(".jqgfirstrow").height();$(".jqgfirstrow td .filterFields").each(function(){$(this).appendTo("#filterFieldsContainer")});$(".jqgfirstrow").css({height:n+"px"});$("div.filterFields").unbind("keyup");$("div.filterFields").keyup(function(n){n.keyCode=="13"&&$("#btnSearch").click()})};i();$("#tblManpowerMRFApprovalList").jqGrid("GridUnload");$("#tblManpowerMRFApprovalList").jqGrid("GridDestroy");$("#tblManpowerMRFApprovalList").jqGrid({url:MRFApprovalListURL,postData:n,sortname:t==null?"":t.sortname,sortorder:t==null?"":t.sortorder,selrow:t==null?"":t.selrow,pageNumber:t==null?1:t.page,rowNum:t==null?10:t.rowNum,datatype:"json",mtype:"GET",colNames:["ID","MRF ID","Organizational Group","Position Level","Position","Nature of Employment","No. of Applicant","Status","Date Created","Date Approved","Age"],colModel:[{hidden:!0,width:25,key:!0,name:"ID",index:"ID",align:"center",sortable:!0},{name:"MRFID",index:"MRFID",align:"center",sortable:!0,formatter:objMRFApprovalListJS.AddLink},{name:"OrgGroupDescription",index:"OrgGroupDescription",editable:!0,align:"left",sortable:!0},{name:"PositionLevelDescription",index:"PositionLevelDescription",editable:!0,align:"left",sortable:!0},{name:"PositionDescription",index:"PositionDescription",editable:!0,align:"left",sortable:!0},{name:"NatureOfEmployment",index:"NatureOfEmployment",editable:!0,align:"left",sortable:!0},{name:"NoOfApplicant",index:"NoOfApplicant",editable:!0,align:"center",sortable:!0},{name:"Status",index:"Status",editable:!0,align:"left",sortable:!0},{name:"CreatedDate",index:"CreatedDate",editable:!0,align:"left",sortable:!0},{name:"ApprovedDate",index:"ApprovedDate",editable:!0,align:"left",sortable:!0},{name:"Age",index:"Age",editable:!0,align:"center",sortable:!0},],toppager:$("#divPager"),rowList:SetRowList(),loadonce:!1,viewrecords:!0,jsonReader:{root:"rows",page:"page",total:"total",records:"records",repeatitems:!1},emptyrecords:"No records to display",multiselect:!1,rowNumbers:!0,width:"100%",height:"100%",sortable:!0,loadComplete:function(n){if(Loading(!1),n.IsSuccess!=undefined&&(n.IsSuccess||($("#divErrorMessage").html(""),ModalAlert(MODAL_HEADER,n.Result))),n.rows!=null){if(n.rows.length>0)for(var t=0;t<n.rows.length;t++);AutoSizeColumnJQGrid("tblManpowerMRFApprovalList",n);$("#filterFieldsContainer .filterFields").each(function(n){$(this).appendTo(".jqgfirstrow td:nth-child("+(n+2)+")")});$("#tblManpowerMRFApprovalList .jqgrid-id-link").click(function(){$("#divMRFApprovalModal").modal("show")})}localStorage.MRFApprovalListFilterOption!=undefined&&$("#chkFilter").prop("checked",JSON.parse(localStorage.MRFApprovalListFilterOption));objMRFApprovalListJS.ShowHideFilter();$("#chkFilter").on("change",function(){objMRFApprovalListJS.ShowHideFilter();localStorage.MRFApprovalListFilterOption=$("#chkFilter").is(":checked")});$(".ui-jqgrid-bdiv").css({"min-height":"400px"})},loadError:function(n){ModalAlert(MODAL_HEADER,n.responseText);Loading(!1)},beforeRequest:function(){GetJQGridState("tblManpowerMRFApprovalList");i()}}).navGrid("#divPager",{edit:!1,add:!1,del:!1,search:!1,refresh:!1});jQuery(".ui-pg-selbox").closest("select").before('<label class="ui-row-label">Show<\/label>');jQuery(".ui-row-label").closest("label").before('<label class="ui-row-label" id="lblFilter">Show Filter<\/label>');jQuery("#lblFilter").after('<input type="checkbox" id="chkFilter" style="margin-right:15px; margin-top: 5px;"><\/div>')},SetLocalStorage:function(){localStorage.ManpowerMRFApprovalListID=$("#txtFilterMRFID").val();localStorage.ManpowerMRFApprovalListMRFTransactionID=$("#txtFilterMRFTransactionID").val();localStorage.ManpowerMRFApprovalListOrgGroupDelimited=objEMSCommonJS.GetMultiSelectList("multiSelectedOrgGroup").value;localStorage.ManpowerMRFApprovalListOrgGroupDelimitedText=objEMSCommonJS.GetMultiSelectList("multiSelectedOrgGroup").text;localStorage.ManpowerMRFApprovalListPositionLevelDelimited=objEMSCommonJS.GetMultiSelectList("multiSelectedPositionLevel").value;localStorage.ManpowerMRFApprovalListPositionLevelDelimitedText=objEMSCommonJS.GetMultiSelectList("multiSelectedPositionLevel").text;localStorage.ManpowerMRFApprovalListPositionDelimited=objEMSCommonJS.GetMultiSelectList("multiSelectedPosition").value;localStorage.ManpowerMRFApprovalListPositionDelimitedText=objEMSCommonJS.GetMultiSelectList("multiSelectedPosition").text;localStorage.ManpowerMRFApprovalListNatureOfEmploymentDelimited=objEMSCommonJS.GetMultiSelectList("multiSelectedNatureOfEmployment").value;localStorage.ManpowerMRFApprovalListNatureOfEmploymentDelimitedText=objEMSCommonJS.GetMultiSelectList("multiSelectedNatureOfEmployment").text;localStorage.ManpowerMRFApprovalListNoOfApplicantMin=$("#txtFilterNoOfApplicantMin").val();localStorage.ManpowerMRFApprovalListNoOfApplicantMax=$("#txtFilterNoOfApplicantMax").val();localStorage.ManpowerMRFApprovalListStatusDelimited=objEMSCommonJS.GetMultiSelectList("multiSelectedStatus").value;localStorage.ManpowerMRFApprovalListStatusDelimitedText=objEMSCommonJS.GetMultiSelectList("multiSelectedStatus").text;localStorage.ManpowerMRFApprovalListDateCreatedFrom=$("#txtFilterDateCreatedFrom").val();localStorage.ManpowerMRFApprovalListDateCreatedTo=$("#txtFilterDateCreatedTo").val();localStorage.ManpowerMRFApprovalListDateApprovedFrom=$("#txtFilterDateApprovedFrom").val();localStorage.ManpowerMRFApprovalListDateApprovedTo=$("#txtFilterDateApprovedTo").val();localStorage.ManpowerMRFApprovalListAgeMin=$("#txtFilterAgeMin").val();localStorage.ManpowerMRFApprovalListAgeMax=$("#txtFilterAgeMax").val()},GetLocalStorage:function(){$("#txtFilterMRFID").val(localStorage.ManpowerMRFApprovalListID);$("#txtFilterMRFTransactionID").val(localStorage.ManpowerMRFApprovalListMRFTransactionID);objEMSCommonJS.SetMultiSelectList("multiSelectedOrgGroup","ManpowerMRFApprovalListOrgGroupDelimited","ManpowerMRFApprovalListOrgGroupDelimitedText");objEMSCommonJS.SetMultiSelectList("multiSelectedPositionLevel","ManpowerMRFApprovalListPositionLevelDelimited","ManpowerMRFApprovalListPositionLevelDelimitedText");objEMSCommonJS.SetMultiSelectList("multiSelectedPosition","ManpowerMRFApprovalListPositionDelimited","ManpowerMRFApprovalListPositionDelimitedText");objEMSCommonJS.SetMultiSelectList("multiSelectedNatureOfEmployment","ManpowerMRFApprovalListNatureOfEmploymentDelimited","ManpowerMRFApprovalListNatureOfEmploymentDelimitedText");$("#txtFilterNoOfApplicantMin").val(localStorage.ManpowerMRFApprovalListNoOfApplicantMin);$("#txtFilterNoOfApplicantMax").val(localStorage.ManpowerMRFApprovalListNoOfApplicantMax);objEMSCommonJS.SetMultiSelectList("multiSelectedStatus","ManpowerMRFApprovalListStatusDelimited","ManpowerMRFApprovalListStatusDelimitedText");$("#txtFilterDateCreatedFrom").val(localStorage.ManpowerMRFApprovalListDateCreatedFrom);$("#txtFilterDateCreatedTo").val(localStorage.ManpowerMRFApprovalListDateCreatedTo);$("#txtFilterDateApprovedFrom").val(localStorage.ManpowerMRFApprovalListDateApprovedFrom);$("#txtFilterDateApprovedTo").val(localStorage.ManpowerMRFApprovalListDateApprovedTo);$("#txtFilterAgeMin").val(localStorage.ManpowerMRFApprovalListAgeMin);$("#txtFilterAgeMax").val(localStorage.ManpowerMRFApprovalListAgeMax)},AddLink:function(n,t,i){return"<a href=\"\" class='jqgrid-id-link' onclick=\"return LoadPartial('"+MRFApprovalEditURL+"?ID="+i.ID+"&RecordStatus="+i.Status+"', 'divMRFApprovalBodyModal');\">"+i.MRFID+"<\/a>"},LoadApprovalHistoryJQGrid:function(n){var t=this;Loading(!0);$("#tblMRFFormApprovalHistoryList").jqGrid("GridUnload");$("#tblMRFFormApprovalHistoryList").jqGrid("GridDestroy");$("#tblMRFFormApprovalHistoryList").jqGrid({url:GetApprovalHistoryURL,postData:n,sortname:"",sortorder:"",selrow:"",pageNumber:1,rowNum:10,datatype:"json",mtype:"GET",colNames:["Level","Approver Name","Status","Remarks","Timestamp","","",""],colModel:[{name:"HierarchyLevel",index:"HierarchyLevel",align:"left",sortable:!1},{name:"ApproverName",index:"ApproverName",align:"left",sortable:!1},{name:"ApprovalStatus",index:"ApprovalStatus",align:"left",sortable:!1},{name:"ApprovalRemarks",index:"ApprovalRemarks",align:"left",sortable:!1},{name:"ApprovedDate",index:"ApprovedDate",align:"left",sortable:!1},{hidden:!0,name:"PositionID",index:"PositionID",align:"left",sortable:!1},{hidden:!0,name:"OrgGroupID",index:"OrgGroupID",align:"left",sortable:!1},{hidden:!0,name:"ApprovalStatusCode",index:"ApprovalStatusCode",align:"left",sortable:!1},],rowList:SetRowList(),loadonce:!1,viewrecords:!0,jsonReader:{root:"rows",page:"page",total:"total",records:"records",repeatitems:!1},emptyrecords:"No records to display",multiselect:!1,rowNumbers:!0,width:"100%",height:"100%",sortable:!0,loadComplete:function(n){if(Loading(!1),n.IsSuccess!=undefined&&(n.IsSuccess||($("#divErrorMessage").html(""),ModalAlert(MODAL_HEADER,n.Result))),n.rows!=null){if(n.rows.length>0)for(var t=0;t<n.rows.length;t++);AutoSizeColumnJQGrid("tblMRFFormApprovalHistoryList",n)}},loadError:function(n){ModalAlert(MODAL_HEADER,n.responseText);Loading(!1)}})},GetComment:function(){var t={MRFID:$("#hdnID").val()},n;$("#txtAreaComments").val("");n=function(n){n.IsSuccess==!0&&($("#divCommentsContainer").html(""),n.Result.length>0?($("#divCommentsContainer").append("<span class='comment-details'>-- Start --<\/span><br>"),$(n.Result).each(function(n,t){$("#divCommentsContainer").append("<span class='comment-details'>"+t.Timestamp+" "+t.Sender+": <\/span><span class='comment'> "+t.Comments+"<\/span><br>")}),n.Result.length<=index+1&&setTimeout(function(){$("#divCommentsContainer").scrollTop($("#divCommentsContainer")[0].scrollHeight)},300)):$("#divCommentsContainer").append("<span class='comment-details'>-- No comments found. --<\/span><br>"),$("#txtAreaComments").attr("readonly",!1),$("#txtAreaComments").prop("disabled",!1))};objEMSCommonJS.GetAjax(GetCommentsURL,t,"",n)},GetComment:function(){var t={MRFID:$("#hdnID").val()},n;$("#txtAreaComments").val("");n=function(n){n.IsSuccess==!0&&($("#divCommentsContainer").html(""),n.Result.length>0?($("#divCommentsContainer").append("<span class='comment-header'>-- Start --<\/span>"),$(n.Result).each(function(n,t){$("#divCommentsContainer").append("<span class='comment-details'>"+t.Timestamp+" "+t.Sender+": <\/span><span class='comment'> "+t.Comments+"<\/span><br>")}),$("#divCommentsContainer").scrollTop($("#divCommentsContainer")[0].scrollHeight)):$("#divCommentsContainer").append("<span class='comment-header'>-- No comments found. --<\/span>"),$("#txtAreaComments").attr("readonly",!1),$("#txtAreaComments").prop("disabled",!1))};objEMSCommonJS.GetAjax(GetCommentsURL,t,"",n)},GetCommentSectionFormData:function(){var n=new FormData($("#frmMRFApproval").get(0));return n.append("CommentsForm.MRFID",$("#hdnID").val()),n.append("CommentsForm.Comments",$("#txtAreaComments").val()),n},ShowHideFilter:function(){$("#chkFilter").is(":checked")?$(".jqgfirstrow .filterFields").show():$("#chkFilter").is(":not(:checked)")&&$(".jqgfirstrow .filterFields").hide()}};objMRFApprovalListJS.Initialize()});