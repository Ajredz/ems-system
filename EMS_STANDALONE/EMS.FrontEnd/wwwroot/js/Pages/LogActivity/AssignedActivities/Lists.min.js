var objAssignedActivitiesListJS;const AssignedActivitiesListURL=window.location.pathname+"?handler=List",GetApplicantLogActivitiesURL=window.location.pathname+"?handler=ApplicantLogActivities",GetCurrentStatusURL=window.location.pathname+"?handler=ReferenceValue&RefCode=ACTIVITY_STAT_FILTER",GetTypeURL=window.location.pathname+"?handler=ReferenceValue&RefCode=ACTIVITY_TYPE",GetSubTypeURL=window.location.pathname+"?handler=LogActivitySubType",UpdateLogActivityURL=window.location.pathname+"/Edit",UpdateApplicantLogActivityPostURL=window.location.pathname+"/Edit?handler=Applicant",UpdateEmployeeLogActivityPostURL=window.location.pathname+"/Edit?handler=Employee",ReferredByAutoComplete=window.location.pathname+"?handler=ReferredBy",GetApplicantLogActivityStatusHistoryURL=window.location.pathname+"?handler=ApplicantLogActivityStatusHistory",GetEmployeeLogActivityStatusHistoryURL=window.location.pathname+"?handler=EmployeeLogActivityStatusHistory",GetApplicantCommentsURL=window.location.pathname+"/Edit?handler=ApplicantComments",SaveApplicantCommentsURL=window.location.pathname+"/Edit?handler=SaveApplicantComments",GetEmployeeCommentsURL=window.location.pathname+"/Edit?handler=EmployeeComments",SaveEmployeeCommentsURL=window.location.pathname+"/Edit?handler=SaveEmployeeComments",GetApplicantAttachmentURL=window.location.pathname+"/Edit?handler=ApplicantAttachment",SaveApplicantAttachmentURL=window.location.pathname+"/Edit?handler=SaveApplicantAttachment",GetEmployeeAttachmentURL=window.location.pathname+"/Edit?handler=EmployeeAttachment",SaveEmployeeAttachmentURL=window.location.pathname+"/Edit?handler=SaveEmployeeAttachment",CheckFileIfExistsURL=window.location.pathname+"/Edit?handler=CheckFileIfExists",DownloadFileURL=window.location.pathname+"/Edit?handler=DownloadFile",AttachmentTypeDropDown=window.location.pathname+"/Edit?handler=ReferenceValue&RefCode=ATTACHMENT_TYPE",TaskBatchUpdateURL=window.location.pathname+"/BatchUpdate",TaskBatchUpdatePostURL=window.location.pathname+"/BatchUpdate",EmployeeAutoCompleteURL=window.location.pathname+"?handler=EmployeeAutoComplete",ApplicantAutoCompleteURL=window.location.pathname+"?handler=ApplicantAutoComplete",OrgGroupAutoCompleteURL=window.location.pathname+"?handler=OrgGroupAutoComplete",BatchStatusDropDownURL=window.location.pathname+"/BatchUpdate?handler=BatchStatusDropDown",GetCheckExportListURL=window.location.pathname+"?handler=CheckExportList",DownloadExportListURL=window.location.pathname+"?handler=DownloadExportList";$(document).ready(function(){objAssignedActivitiesListJS={Initialize:function(){var n=this,t;n.ElementBinding();t={ID:localStorage.AssignedActivitiesListID,EmployeeDelimited:localStorage.AssignedActivitiesListEmployee,ApplicantDelimited:localStorage.AssignedActivitiesListApplicant,TypeDelimited:localStorage.AssignedActivitiesListType,Title:localStorage.AssignedActivitiesListTitle,CurrentStatusDelimited:localStorage.AssignedActivitiesListCurrentStatus,CurrentTimestampFrom:localStorage.AssignedActivitiesListCurrentTimestampFrom,CurrentTimestampTo:localStorage.AssignedActivitiesListCurrentTimestampTo,DueDateFrom:localStorage.AssignedActivitiesListDueDateFrom,DueDateTo:localStorage.AssignedActivitiesListDueDateTo,AssignedByDelimited:localStorage.AssignedActivitiesListAssignedBy,OrgGroupDelimited:localStorage.AssignedActivitiesListOrgGroup};n.LoadJQGrid(t);n.GetLocalStorage();objEMSCommonJS.ChangeTab($(".tablinks:nth-child(1)"),"tabHistory","#divLogActivityModal");window.location.pathname.indexOf("all")>=0&&$(".list-title").text("All Tasks")},ElementBinding:function(){var n=this;$("#txtFilterCurrentTimestampFrom, #txtFilterCurrentTimestampTo").datetimepicker({useCurrent:!1,format:"MM/DD/YYYY"});$("#txtFilterDueDateFrom, #txtFilterDueDateTo").datetimepicker({useCurrent:!1,format:"MM/DD/YYYY"});objEMSCommonJS.BindFilterMultiSelectAutoComplete("txtFilterAssignedBy",ReferredByAutoComplete,20,"multiSelectedAssignedBy");objEMSCommonJS.BindFilterMultiSelectAutoComplete("txtFilterEmployee",EmployeeAutoCompleteURL,20,"multiSelectedEmployee");objEMSCommonJS.BindFilterMultiSelectAutoComplete("txtFilterApplicant",ApplicantAutoCompleteURL,20,"multiSelectedApplicant");objEMSCommonJS.BindFilterMultiSelectAutoComplete("txtFilterOrgGroup",OrgGroupAutoCompleteURL,20,"multiSelectedOrgGroup");$("#btnSearch").click(function(){var t={ID:$("#txtFilterAssignedTaskID").val(),EmployeeDelimited:objEMSCommonJS.GetMultiSelectList("multiSelectedEmployee").value,ApplicantDelimited:objEMSCommonJS.GetMultiSelectList("multiSelectedApplicant").value,TypeDelimited:objEMSCommonJS.GetMultiSelectList("multiSelectedType").value,Title:$("#txtFilterTitle").val(),CurrentStatusDelimited:objEMSCommonJS.GetMultiSelectList("multiSelectedCurrentStatus").value,CurrentTimestampFrom:$("#txtFilterCurrentTimestampFrom").val(),CurrentTimestampTo:$("#txtFilterCurrentTimestampTo").val(),DueDateFrom:$("#txtFilterDueDateFrom").val(),DueDateTo:$("#txtFilterDueDateTo").val(),AssignedByDelimited:objEMSCommonJS.GetMultiSelectList("multiSelectedAssignedBy").value,OrgGroupDelimited:objEMSCommonJS.GetMultiSelectList("multiSelectedOrgGroup").value};n.SetLocalStorage();ResetJQGridState("tblAssignedActivitiesList");n.LoadJQGrid(t);$("#divAssignedActivitiesListErrorMessage").html("")});$("#btnReset").click(function(){$("div.filterFields input[type='search']").val("");$("div.filterFields select").val("");$("div.filterFields input[type='checkbox']").prop("checked",!0);$("#multiSelectedType").html("");$("#multiSelectedTypeOption label, #multiSelectedTypeOption input").prop("title","add");$("#multiSelectedCurrentStatus").html("");$("#multiSelectedCurrentStatusOption label, #multiSelectedCurrentStatusOption input").prop("title","add");$("#multiSelectedAssignedBy").html("");$("#multiSelectedAssignedByOption label, #multiSelectedAssignedByOption input").prop("title","add");$("#multiSelectedEmployee").html("");$("#multiSelectedEmployeeOption label, #multiSelectedEmployeeOption input").prop("title","add");$("#multiSelectedApplicant").html("");$("#multiSelectedApplicantOption label, #multiSelectedApplicantOption input").prop("title","add");$("#multiSelectedOrgGroup").html("");$("#multiSelectedOrgGroupOption label, #multiSelectedOrgGroupOption input").prop("title","add");$("#btnSearch").click()});$("#btnBatchUpdate").click(function(){for(var r,n=$("#tblAssignedActivitiesList").jqGrid("getGridParam","selarrrow"),i=[],t=0;t<n.length;t++)r=$("#tblAssignedActivitiesList").jqGrid("getRowData",n[t]),i.push(r.CurrentStatus);n.length==0?$("#divAssignedActivitiesListErrorMessage").html('<label class="errMessage"><li>Please select atleast one task<\/li><\/label><br />'):objAssignedActivitiesListJS.ArrayUnique(i)?$("#divAssignedActivitiesListErrorMessage").html('<label class="errMessage"><li>Please select tasks with same current status only<\/li><\/label><br />'):($("#divAssignedActivitiesListErrorMessage").html(""),LoadPartial(TaskBatchUpdateURL,"divTaskBatchUpdateBodyModal"),$("#divTaskBatchUpdateModal").modal("show"))});$("#btnExport").click(function(){ModalConfirmation(MODAL_HEADER,MSG_CONFIRM,"objAssignedActivitiesListJS.ExportFunction()","function")});objEMSCommonJS.BindFilterMultiSelectEnumValueDisplay("multiSelectedType",GetTypeURL,"Value","Description");objEMSCommonJS.BindFilterMultiSelectEnumValueDisplay("multiSelectedCurrentStatus",GetCurrentStatusURL,"Value","Description")},ExportFunction:function(){var n="&sidx="+$("#tblAssignedActivitiesList").jqGrid("getGridParam","sortname")+"&sord="+$("#tblAssignedActivitiesList").jqGrid("getGridParam","sortorder")+"&ID="+$("#txtFilterAssignedTaskID").val()+"&EmployeeDelimited="+objEMSCommonJS.GetMultiSelectList("multiSelectedEmployee").value+"&ApplicantDelimited="+objEMSCommonJS.GetMultiSelectList("multiSelectedApplicant").value+"&TypeDelimited="+objEMSCommonJS.GetMultiSelectList("multiSelectedType").value+"&Title="+$("#txtFilterTitle").val()+"&CurrentStatusDelimited="+objEMSCommonJS.GetMultiSelectList("multiSelectedCurrentStatus").value+"&CurrentTimestampFrom="+$("#txtFilterCurrentTimestampFrom").val()+"&CurrentTimestampTo="+$("#txtFilterCurrentTimestampTo").val()+"&DueDateFrom="+$("#txtFilterDueDateFrom").val()+"&DueDateTo="+$("#txtFilterDueDateTo").val()+"&AssignedByDelimited="+objEMSCommonJS.GetMultiSelectList("multiSelectedAssignedBy").value+"&OrgGroupDelimited="+objEMSCommonJS.GetMultiSelectList("multiSelectedOrgGroup").value,t=function(t){t.IsSuccess==!0?(window.location=DownloadExportListURL+n,$("#divModal").modal("hide")):ModalAlert(MODAL_HEADER,t.Result)};objEMSCommonJS.GetAjax(GetCheckExportListURL+n,{},"#btnExport",t,null,!0)},LoadJQGrid:function(n){var r=this,t,i;Loading(!0);t=localStorage.getItem("tblAssignedActivitiesList")==""?"":$.parseJSON(localStorage.getItem("tblAssignedActivitiesList"));i=function(){var n=$(".jqgfirstrow").height();$(".jqgfirstrow td .filterFields").each(function(){$(this).appendTo("#filterFieldsContainer")});$(".jqgfirstrow").css({height:n+"px"});$("div.filterFields").unbind("keyup");$("div.filterFields").keyup(function(n){n.keyCode=="13"&&$("#btnSearch").click()})};i();$("#tblAssignedActivitiesList").jqGrid("GridUnload");$("#tblAssignedActivitiesList").jqGrid("GridDestroy");$("#tblAssignedActivitiesList").jqGrid({url:AssignedActivitiesListURL,postData:n,sortname:t==null?"":t.sortname,sortorder:t==null?"":t.sortorder,selrow:t==null?"":t.selrow,pageNumber:t==null?1:t.page,rowNum:t==null?10:t.rowNum,datatype:"json",mtype:"GET",colNames:["ID","Type","Sub-Type","Title","Description","Assigned By","Due Date","Current Status","Employee Name","Applicant Name","Org Group","Timestamp","Remarks","","",""],colModel:[{width:100,key:!0,name:"ID",index:"ID",align:"center",sortable:!1,formatter:objAssignedActivitiesListJS.UpdateLink},{name:"Type",index:"Type",align:"left",sortable:!1},{hidden:!0,name:"SubType",index:"SubType",align:"left",sortable:!1},{name:"Title",index:"Title",align:"left",sortable:!1},{hidden:!0,name:"Description",index:"Description",align:"left",sortable:!1},{name:"AssignedBy",index:"AssignedBy",align:"left",sortable:!1},{name:"DueDate",index:"DueDate",align:"left",sortable:!1},{name:"CurrentStatus",index:"CurrentStatus",align:"left",sortable:!1},{width:200,name:"EmployeeName",index:"EmployeeName",align:"left",sortable:!1},{width:200,name:"ApplicantName",index:"ApplicantName",align:"left",sortable:!1},{name:"OrgGroupName",index:"OrgGroupName",align:"left",sortable:!1},{name:"CurrentTimestamp",index:"CurrentTimestamp",align:"left",sortable:!1},{hidden:!0,name:"Remarks",index:"Remarks",align:"left",sortable:!1},{hidden:!0,name:"ApplicantID",index:"ApplicantID",align:"left",sortable:!1},{hidden:!0,name:"EmployeeID",index:"EmployeeID",align:"left",sortable:!1},{hidden:!0,name:"CurrentStatusCode",index:"CurrentStatusCode",align:"left",sortable:!1},],toppager:$("#divPager"),rowList:SetRowList(),loadonce:!1,viewrecords:!0,jsonReader:{root:"rows",page:"page",total:"total",records:"records",repeatitems:!1},emptyrecords:"No records to display",multiselect:!0,rowNumbers:!0,width:"100%",height:"100%",sortable:!0,ondblClickRow:function(n,t){$("#tblAssignedActivitiesList tr:nth-child("+(t+1)+") .activity-id-link").click()},loadComplete:function(n){if(Loading(!1),n.IsSuccess!=undefined&&(n.IsSuccess||($("#divErrorMessage").html(""),ModalAlert(MODAL_HEADER,n.Result))),n.rows!=null){if(n.rows.length>0)for(var t=0;t<n.rows.length;t++)(n.rows[t].CurrentStatus=="DONE"||n.rows[t].CurrentStatus=="CANCELLED")&&$("#jqg_tblAssignedActivitiesList_"+n.rows[t].ID).attr("disabled",!0);AutoSizeColumnJQGrid("tblAssignedActivitiesList",n);$("#filterFieldsContainer .filterFields").each(function(n){$(this).appendTo(".jqgfirstrow td:nth-child("+(n+2)+")")});$("#tblAssignedActivitiesList .jqgrid-id-link").click(function(){$("#divLogActivityModal").modal("show")})}localStorage.AssignedActivitiesListFilterOption!=undefined&&$("#chkFilter").prop("checked",JSON.parse(localStorage.AssignedActivitiesListFilterOption));objAssignedActivitiesListJS.ShowHideFilter();$("#chkFilter").on("change",function(){objAssignedActivitiesListJS.ShowHideFilter();localStorage.AssignedActivitiesListFilterOption=$("#chkFilter").is(":checked")});$(".ui-jqgrid-bdiv").css({"min-height":"400px"});$("table tr.jqgfirstrow td").each(function(n){var t=n+1;$("table .jqgfirstrow td:nth-child("+t+")").find("input[type='search']").length&&$("table .jqgfirstrow td:nth-child("+t+") input").val()!=""&&($(".ui-jqgrid-htable tr th:nth-child("+t+")").addClass("filtered"),$(".ui-jqgrid-htable tr th:nth-child("+t+").filtered div").find("span.glyphicon-table-header").length==0&&$(".ui-jqgrid-htable tr th:nth-child("+t+").filtered div").prepend('<span class="glyphicon glyphicon-filter glyphicon-table-header"><\/span>'));$("table .jqgfirstrow td:nth-child("+t+")").find("input[type='number']").length&&$("table .jqgfirstrow td:nth-child("+t+") input").val()!=""&&($(".ui-jqgrid-htable tr th:nth-child("+t+")").addClass("filtered"),$(".ui-jqgrid-htable tr th:nth-child("+t+").filtered div").find("span.glyphicon-table-header").length==0&&$(".ui-jqgrid-htable tr th:nth-child("+t+").filtered div").prepend('<span class="glyphicon glyphicon-filter glyphicon-table-header"><\/span>'));$("table .jqgfirstrow td:nth-child("+t+")").find("div.multiselect-control").length&&$("table .jqgfirstrow td:nth-child("+t+") div.multiselect-control").text()!=""&&($(".ui-jqgrid-htable tr th:nth-child("+t+")").addClass("filtered"),$(".ui-jqgrid-htable tr th:nth-child("+t+").filtered div").find("span.glyphicon-table-header").length==0&&$(".ui-jqgrid-htable tr th:nth-child("+t+").filtered div").prepend('<span class="glyphicon glyphicon-filter glyphicon-table-header"><\/span>'))})},onSelectAll:function(n,t){if(t){var i=$("tr.jqgrow > td > input.cbox:disabled",$(this));i.removeAttr("checked");$(this)[0].p.selarrrow=$(this).find("tr.jqgrow:has(td > input.cbox:checked)").map(function(){return this.id}).get()}},beforeSelectRow:function(n){var t=$("tr#"+n+".jqgrow > td > input.cbox:disabled",$(this));return t.length==0?!0:!1},loadError:function(n){ModalAlert(MODAL_HEADER,n.responseText);Loading(!1)},beforeRequest:function(){GetJQGridState("tblAssignedActivitiesList");i()}}).navGrid("#divPager",{edit:!1,add:!1,del:!1,search:!1,refresh:!1});jQuery(".ui-pg-selbox").closest("select").before('<label class="ui-row-label">Show<\/label>');jQuery(".ui-row-label").closest("label").before('<label class="ui-row-label" id="lblFilter">Show Filter<\/label>');jQuery("#lblFilter").after('<input type="checkbox" id="chkFilter" style="margin-right:15px; margin-top: 5px;"><\/div>')},SetLocalStorage:function(){localStorage.AssignedActivitiesListID=$("#txtFilterAssignedTaskID").val();localStorage.AssignedActivitiesListType=objEMSCommonJS.GetMultiSelectList("multiSelectedType").value;localStorage.AssignedActivitiesListTypeText=objEMSCommonJS.GetMultiSelectList("multiSelectedType").text;localStorage.AssignedActivitiesListTitle=$("#txtFilterTitle").val();localStorage.AssignedActivitiesListCurrentStatus=objEMSCommonJS.GetMultiSelectList("multiSelectedCurrentStatus").value;localStorage.AssignedActivitiesListCurrentStatusText=objEMSCommonJS.GetMultiSelectList("multiSelectedCurrentStatus").text;localStorage.AssignedActivitiesListCurrentTimestampFrom=$("#txtFilterCurrentTimestampFrom").val();localStorage.AssignedActivitiesListCurrentTimestampTo=$("#txtFilterCurrentTimestampTo").val();localStorage.AssignedActivitiesListDueDateFrom=$("#txtFilterDueDateFrom").val();localStorage.AssignedActivitiesListDueDateTo=$("#txtFilterDueDateTo").val();localStorage.AssignedActivitiesListAssignedBy=objEMSCommonJS.GetMultiSelectList("multiSelectedAssignedBy").value;localStorage.AssignedActivitiesListAssignedByText=objEMSCommonJS.GetMultiSelectList("multiSelectedAssignedBy").text;localStorage.AssignedActivitiesListEmployee=objEMSCommonJS.GetMultiSelectList("multiSelectedEmployee").value;localStorage.AssignedActivitiesListEmployeeText=objEMSCommonJS.GetMultiSelectList("multiSelectedEmployee").text;localStorage.AssignedActivitiesListApplicant=objEMSCommonJS.GetMultiSelectList("multiSelectedApplicant").value;localStorage.AssignedActivitiesListApplicantText=objEMSCommonJS.GetMultiSelectList("multiSelectedApplicant").text;localStorage.AssignedActivitiesListOrgGroup=objEMSCommonJS.GetMultiSelectList("multiSelectedOrgGroup").value;localStorage.AssignedActivitiesListOrgGroupText=objEMSCommonJS.GetMultiSelectList("multiSelectedOrgGroup").text},GetLocalStorage:function(){$("#txtFilterAssignedTaskID").val(localStorage.AssignedActivitiesListID);objEMSCommonJS.SetMultiSelectList("multiSelectedType","AssignedActivitiesListType","AssignedActivitiesListTypeText");$("#txtFilterTitle").val(localStorage.AssignedActivitiesListTitle);objEMSCommonJS.SetMultiSelectList("multiSelectedCurrentStatus","AssignedActivitiesListCurrentStatus","AssignedActivitiesListCurrentStatusText");objEMSCommonJS.SetMultiSelectList("multiSelectedAssignedBy","AssignedActivitiesListAssignedBy","AssignedActivitiesListAssignedByText");$("#txtFilterCurrentTimestampFrom").val(localStorage.AssignedActivitiesListCurrentTimestampFrom);$("#txtFilterCurrentTimestampTo").val(localStorage.AssignedActivitiesListCurrentTimestampTo);$("#txtFilterDueDateFrom").val(localStorage.AssignedActivitiesListDueDateFrom);$("#txtFilterDueDateTo").val(localStorage.AssignedActivitiesListDueDateTo);objEMSCommonJS.SetMultiSelectList("multiSelectedEmployee","AssignedActivitiesListEmployee","AssignedActivitiesListEmployeeText");objEMSCommonJS.SetMultiSelectList("multiSelectedApplicant","AssignedActivitiesListApplicant","AssignedActivitiesListApplicantText");objEMSCommonJS.SetMultiSelectList("multiSelectedOrgGroup","AssignedActivitiesListOrgGroup","AssignedActivitiesListOrgGroupText")},UpdateLink:function(n,t,i){return"<a href=\"\" class='activity-id-link' onclick=\"return objAssignedActivitiesListJS.ViewUpdateStatusModal('"+UpdateLogActivityURL+"?ID="+i.ID+"&ApplicantID="+i.ApplicantID+"&EmployeeID="+i.EmployeeID+"');\">"+objEMSCommonJS.JQGridIDFormat(i.ID)+"<\/a>"},ViewUpdateStatusModal:function(n){return $("#divLogActivityModal").modal("show"),LoadPartial(n,"divLogActivityBodyModal"),!1},ShowHideFilter:function(){$("#chkFilter").is(":checked")?$(".jqgfirstrow .filterFields").show():$("#chkFilter").is(":not(:checked)")&&$(".jqgfirstrow .filterFields").hide()},ArrayUnique:function(n){return n.length!==0&&new Set(n).size!==1}};objAssignedActivitiesListJS.Initialize()});