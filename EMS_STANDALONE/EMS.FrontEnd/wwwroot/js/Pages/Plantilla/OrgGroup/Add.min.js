var objOrgGroupAddJS;$(document).ready(function(){objOrgGroupAddJS={Initialize:function(){$("#divOrgGroupBodyModal .modal-header").mousedown(handle_mousedown);var n=this;n.ElementBinding();$("#divOrgGroupModal #btnSave").show();$("#divOrgGroupModal .form-control:not(.TotalFields)").attr("readonly",!1);$("#divOrgGroupModal #btnDelete, #divOrgGroupModal #btnBack").remove();$(".tablinks:nth-child(2)").hide();$(".tablinks:nth-child(3)").hide();$(".tablinks:nth-child(5)").hide();n.AddChildrenManPowerDynamicFields();n.LoadChildrenOrgGroup();objEMSCommonJS.ChangeTab($(".tablinks:nth-child(1)"),"tabOrgGroupPosition")},AddSuccessFunction:function(){$("#divOrgGroupTableList #btnSearch").click();$("#frmOrgGroup").trigger("reset");$("#ddlListTwoOrgGroup").empty();$("#divOrgGroupTags").html("");$(".tablinks:nth-child(3)").hide();$("#DivChildrenManPowerDynamicFields").empty();objOrgGroupAddJS.LoadChildrenOrgGroup();objOrgGroupAddJS.AddChildrenManPowerDynamicFields();objEMSCommonJS.ChangeTab($(".tablinks:nth-child(1)"),"tabOrgGroupPosition");$("#divHierarchyUpward").html("");$(".TotalFields, .VarianceDynamicFields").empty()},ElementBinding:function(){var t=this,n;Code($("#txtCode"));NumberOnly($("#txtServiceBayCount"));PreventSpace($("#txtCode"));$("#txtCode").bind("copy paste cut",function(n){n.preventDefault()});$("#ddlOrgType").change(function(){$("#divOrgGroupTags").html("");$(this).val()=="TOP"?($("#reqParentGroup").hide(),$("#txtParentOrgGroup").removeClass("required-field")):($("#reqParentGroup").show(),$("#txtParentOrgGroup").addClass("required-field"));var n=function(n){n.Result.length!=0?($(n.Result).each(function(n,t){$("#divOrgGroupTags").append('<div class="form-group form-fields">                                 <div class="col-md-2-5 col-label">                                     <label class="control-label block-label" for="ddl'+t.Value+'"> <span class="reqField">* <\/span>'+t.Description+'<\/label>                                 <\/div>                                 <div class="col-md-4">                                     <input type="hidden" id="hdnCode_'+t.Value+'" value="'+t.Value+'" class="OrgGroupTagList_Code"/>                                     <select id="ddl'+t.Value+'" title="'+t.Description+'" class="form-control required-field OrgGroupTagList_Value">                                         <option value="">- Select an item -<\/option>                                     <\/select>                                 <\/div>                             <\/div>');$(t.DropDownOptions).each(function(n,i){$("#ddl"+t.Value).append('<option value="'+i.Value+'">'+i.Description+"<\/option>")})}),$(".tablinks:nth-child(3)").show()):$(".tablinks:nth-child(3)").hide()};objEMSCommonJS.GetAjax(GetOrgGroupTagsByOrgGroupTypeURL+"ORG_"+$(this).val()+"_TAGS",{},"",n)});n=function(n){if(n!=""){var t=function(n){var r=n.Result.length,t=$("#txtCode").val(),i=$("#txtDescription").val();$("#divHierarchyUpward").html("");$(n.Result).each(function(n,t){$("#divHierarchyUpward").append(t.Code+" - "+t.Description+" > ")});t!=""&&$("#divHierarchyUpward").append(t+" - "+i)};objEMSCommonJS.GetAjax(OrgTypeHierarchyUpwardURL+"&ID="+n,{},"",t,null,!1)}};objEMSCommonJS.BindAutoComplete("divOrgGroupModal #txtParentOrgGroup",ParentOrgGroupAutoCompleteURL,20,"divOrgGroupModal #hdnParentOrgID","ID","Description",n);$("#txtParentOrgGroup").change(function(){$("#txtParentOrgGroup").val()==""&&$("#divHierarchyUpward").html("")});$("#btnMoveToListTwo").click(function(){ListBoxMove("ddlListOneOrgGroup","ddlListTwoOrgGroup",!1,!0)});$("#btnMoveToListOne").click(function(){ListBoxMove("ddlListTwoOrgGroup","ddlListOneOrgGroup",!1,!0)});$("#btnMoveToListTwoAll").click(function(){ListBoxMove("ddlListOneOrgGroup","ddlListTwoOrgGroup",!0,!0)});$("#btnMoveToListOneAll").click(function(){ListBoxMove("ddlListTwoOrgGroup","ddlListOneOrgGroup",!0,!0)});$("#txtSearchBoxOne").on("change keyup keydown",function(){ListBoxSearch("ddlListOneOrgGroup",$(this).val(),!1)});$("#txtSearchBoxTwo").on("change keyup keydown",function(){ListBoxSearch("ddlListTwoOrgGroup",$(this).val(),!1)});$("#btnAddChildrenManPowerFields").click(function(){$(".PositionTextDynamicFields").addClass("required-field");$(".PlannedDynamicFields").addClass("required-field");$(".ActiveDynamicFields").addClass("required-field");$(".InactiveDynamicFields").addClass("required-field");var i=$("#DivChildrenManPowerDynamicFields .required-field"),n=!0;i.each(function(){if($(this).val()=="")return $(this).focus(),n=!1,!1});n&&t.AddChildrenManPowerDynamicFields()});$("#btnSave").click(function(){objEMSCommonJS.ValidateBlankFields("#frmOrgGroup","#divOrgGroupErrorMessage",objOrgGroupAddJS.ValidateDuplicateFields)?ModalConfirmation(MODAL_HEADER,MSG_CONFIRM,"objEMSCommonJS.PostAjax(true                         , OrgGroupAddPostURL                         , objOrgGroupAddJS.GetFormData()                         , '#divOrgGroupErrorMessage'                         , '#btnSave'                         , objOrgGroupAddJS.AddSuccessFunction); ","function"):$("#tabOrgGroupPosition .errMessage").length>0?objEMSCommonJS.ChangeTab($(".tablinks:nth-child(1)"),"tabOrgGroupPosition"):$("#tabOrgGroupTag .errMessage").length>0?objEMSCommonJS.ChangeTab($(".tablinks:nth-child(3)"),"tabOrgGroupTag"):$("#tabOrgGroupChildren .errMessage").length>0&&objEMSCommonJS.ChangeTab($(".tablinks:nth-child(4)"),"tabOrgGroupChildren")})},GetFormData:function(){var n=new FormData($("#frmOrgGroup").get(0));return $("#ddlListTwoOrgGroup option").each(function(t){$(this).val()!=""&&n.append("OrgGroup.ChildrenOrgIDList["+t+"]",$(this).val())}),$(".PositionDynamicFields").each(function(t){$(this).val()!=""&&n.append("OrgGroup.OrgGroupPositionList["+t+"].PositionID",$(this).val())}),$(".PlannedDynamicFields").each(function(t){$(this).val()!=""&&n.append("OrgGroup.OrgGroupPositionList["+t+"].PlannedCount",$(this).val())}),$(".ActiveDynamicFields").each(function(t){$(this).val()!=""&&n.append("OrgGroup.OrgGroupPositionList["+t+"].ActiveCount",$(this).val())}),$(".InactiveDynamicFields").each(function(t){$(this).val()!=""&&n.append("OrgGroup.OrgGroupPositionList["+t+"].InactiveCount",$(this).val())}),$(".IsHeadDynamicFields").each(function(t){$(this).val()!=""&&n.append("OrgGroup.OrgGroupPositionList["+t+"].IsHead",$(this).prop("checked"))}),$(".OrgGroupTagList_Code").each(function(t){$(this).val()!=""&&n.append("OrgGroup.OrgGroupTagList["+t+"].Code",$(this).val())}),$(".OrgGroupTagList_Value").each(function(t){$(this).val()!=""&&n.append("OrgGroup.OrgGroupTagList["+t+"].Value",$(this).val())}),$(".ReportingPositionDynamicFields").each(function(t){$(this).val()!=""&&n.append("OrgGroup.OrgGroupPositionList["+t+"].ReportingPositionID",$(this).val())}),n},AddChildrenManPowerDynamicFields:function(){var i=this,t=$(".ChildrenManPowerDynamicFields:last").prop("id"),n=parseInt(t==undefined?0:t.replace("ChildrenManPowerDynamicFields_",""))+1;$("#DivChildrenManPowerDynamicFields").append('<div class="form-group form-fields ChildrenManPowerDynamicFields" id="ChildrenManPowerDynamicFields_'+n+'">                    <div class="col-md-0-75 text-align-center no-padding">                        <input type="checkbox" id="chkIsHead_'+n+'" class="IsHeadDynamicFields" title="Head" readonly>                    <\/div>                    <div class="col-md-3 text-align-center no-padding">                        <input type ="search" placeholder="Search.." id="txtPosition_'+n+'" class="form-control PositionTextDynamicFields" title="Position" maxlength="100">                        <input type="hidden" id="hdnPositionID_'+n+'" class="form-control PositionDynamicFields">                    <\/div>                    <div class="col-md-3 text-align-center no-padding">                        <input type ="search" placeholder="Search.." id="txtReportingPosition_'+n+'" class="form-control ReportingPositionTextDynamicFields" title="Reporting Position" maxlength="100">                        <input type="hidden" id="hdnReportingPositionID_'+n+'" class="form-control ReportingPositionDynamicFields">                    <\/div>                    <div class="col-md-0-75 text-align-center no-padding">                        <input type="text" id="txtPlanned_'+n+'" class="form-control text-amount PlannedDynamicFields" title="Planned">                    <\/div>                    <div class="col-md-0-75 text-align-center no-padding">                        <input type="text" id="txtActive_'+n+'" class="form-control text-amount ActiveDynamicFields" title="Active" readonly>                    <\/div>                    <div class="col-md-0-75 text-align-center no-padding">                        <input type="text" id="txtInactive_'+n+'" class="form-control text-amount InactiveDynamicFields" title="Inactive" readonly>                    <\/div>                    <div class="col-md-0-75 text-align-right no-padding">                        <label id="txtVariance_'+n+'" class="control-label block-label remarks-label text-amount total-label VarianceDynamicFields"><\/label>                    <\/div>                    <div class="col-md-0-5 text-align-center no-padding">                        <span class="btn-glyph-dynamic glyphicon glyphicon-trash"                         onclick="ModalConfirmation(MODAL_HEADER, MSG_CONFIRM_DELETE_SINGLE, &quot;objOrgGroupAddJS.RemoveDynamicFields(\'#ChildrenManPowerDynamicFields_'+n+"')&quot;, &quot;function&quot;);\"><\/span>                    <\/div>                <\/div>");NumberOnly($(".PlannedDynamicFields"));NumberOnly($(".ActiveDynamicFields"));NumberOnly($(".InactiveDynamicFields"));$("#txtActive_"+n+", #txtInactive_"+n).val("0");$("#txtPlanned_"+n+", #txtActive_"+n+", #txtInactive_"+n).keyup(function(){$("#txtVariance_"+n).val(parseInt($("#txtActive_"+n).val()||0)+parseInt($("#txtInactive_"+n).val()||0)-parseInt($("#txtPlanned_"+n).val()||0));$("#txtVariance_"+n).text(parseInt($("#txtActive_"+n).val()||0)+parseInt($("#txtInactive_"+n).val()||0)-parseInt($("#txtPlanned_"+n).val()||0));objOrgGroupListJS.CalculateTotal("VarianceDynamicFields","txtTotalVariance")});$(".IsHeadDynamicFields").on("change",function(){$(".IsHeadDynamicFields").not(this).prop("checked",!1)});$("#txtPlanned_"+n).keyup(function(){objOrgGroupListJS.CalculateTotal("PlannedDynamicFields","txtTotalPlanned")});$("#txtActive_"+n).keyup(function(){objOrgGroupListJS.CalculateTotal("ActiveDynamicFields","txtTotalActive")});$("#txtInactive_"+n).keyup(function(){objOrgGroupListJS.CalculateTotal("InactiveDynamicFields","txtTotalInactive")});objEMSCommonJS.BindAutoComplete("txtPosition_"+n,PositionWithLevelAutoCompleteURL,20,"hdnPositionID_"+n,"ID","Description");objEMSCommonJS.BindAutoComplete("txtReportingPosition_"+n,PositionWithLevelAutoCompleteURL,20,"hdnReportingPositionID_"+n,"ID","Description")},RemoveDynamicFields:function(n){$(n).remove();ModalAlert(MODAL_HEADER,MSG_SUCCESS_DELETE_REC)},ValidateDuplicateFields:function(){var n=!0,t=0,i=0,r=$("#hdnParentOrgID").val();return $("#ddlListTwoOrgGroup option").each(function(){this.value==r&&this.value!=""&&($("#txtParentOrgGroup").addClass("errMessage"),$("#ddlListTwoOrgGroup").addClass("errMessage"),i++)}),$(".PositionDynamicFields").each(function(){if(this.value!=""){var i=this.value,n=$(this).prop("id").replace("hdnPositionID_","");$("#ChildrenManPowerDynamicFields_"+n+" #txtPosition_"+n).removeClass("errMessage");$("#ChildrenManPowerDynamicFields_"+n+" #txtReportingPosition_"+n).removeClass("errMessage");$("#ChildrenManPowerDynamicFields_"+n+" #txtPlanned_"+n).removeClass("errMessage");$("#ChildrenManPowerDynamicFields_"+n+" #txtActive_"+n).removeClass("errMessage");$("#ChildrenManPowerDynamicFields_"+n+" #txtInactive_"+n).removeClass("errMessage");$(".PositionDynamicFields").not(this).filter(function(){this.value==i&&($("#ChildrenManPowerDynamicFields_"+n+" #txtPosition_"+n).addClass("errMessage"),$("#ChildrenManPowerDynamicFields_"+n+" #txtReportingPosition_"+n).addClass("errMessage"),$("#ChildrenManPowerDynamicFields_"+n+" #txtPlanned_"+n).addClass("errMessage"),$("#ChildrenManPowerDynamicFields_"+n+" #txtActive_"+n).addClass("errMessage"),$("#ChildrenManPowerDynamicFields_"+n+" #txtInactive_"+n).addClass("errMessage"),t++)})}}),i>0&&($("#divOrgGroupErrorMessage").html('<label class="errMessage"><li>'+DUPLICATE_PARENT_ORG_GROUP+"<\/li><\/label><br />"),n=!1),t>0&&($("#divOrgGroupErrorMessage").html('<label class="errMessage"><li>'+DUPLICATE_HIGHLIGHTED_FIELDS+"<\/li><\/label><br />"),n=!1),n||$("html, body").animate({scrollTop:0},"slow"),n},LoadChildrenOrgGroup:function(){var n=function(n){$(n.Result).each(function(n,t){$("#ddlListOneOrgGroup").append($("<option/>",{value:t.Value,text:t.Text}))})};objEMSCommonJS.GetAjax(GetOrgGroupChildrenURL,{},"",n)}};objOrgGroupAddJS.Initialize()});