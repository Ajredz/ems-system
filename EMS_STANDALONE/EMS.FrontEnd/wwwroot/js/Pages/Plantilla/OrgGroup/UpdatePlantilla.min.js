var objOrgGroupUpdatePlantillaJS,OrgGroupListBoxOptions=[],PositionLevelDropDownOptions=[],PositionPlannedOld=[],PositionPlannedNew=[],CheckFileIfExistsURL=window.location.pathname+"?handler=CheckFileIfExists",DownloadFileURL=window.location.pathname+"?handler=DownloadFile";$(document).ready(function(){objOrgGroupUpdatePlantillaJS={Initialize:function(){var n=this;n.ElementBinding();objOrgGroupListJS.CalculateTotal("UpdatePlannedDynamicFields","txtUpdateTotalPlanned");objOrgGroupListJS.CalculateTotal("UpdateActiveDynamicFields","txtUpdateTotalActive");objOrgGroupListJS.CalculateTotal("UpdateInactiveDynamicFields","txtUpdateTotalInactive");objOrgGroupListJS.CalculateTotal("UpdateVarianceDynamicFields","txtUpdateTotalVariance");n.LoadOrgGroupNPRF();n.AddNPRFDynamicFields();objEMSCommonJS.ChangeTab($("#divUpdatePlantillaModal .tablinks:nth-child(1)"),"divUpdatePlantillaModal #tabOrgGroupPosition");$("#divUpdatePlantillaModal .UpdatePlannedDynamicFields").each(function(n){PositionPlannedOld.push($("#divUpdatePlantillaModal #hdnUpdatePositionID_"+n).val()+"-"+$(this).val())});$("#divUpdatePlantillaModal .IsHeadDynamicFields").attr("disabled",!0)},EditSuccessFunction:function(){objOrgGroupUpdatePlantillaJS.LoadOrgGroupNPRF();objOrgGroupUpdatePlantillaJS.AddNPRFDynamicFields();$("#btnSearch").click();$("#divUpdatePlantillaModal .IsHeadDynamicFields").attr("disabled",!0)},ElementBinding:function(){var n=this;NumberOnly($(".UpdatePlannedDynamicFields"));NumberOnly($(".UpdateActiveDynamicFields"));NumberOnly($(".UpdateInactiveDynamicFields"));$(".UpdatePlannedDynamicFields").keyup(function(){var n=$(this).prop("id").replace("txtUpdatePlannedCount_","");objOrgGroupListJS.CalculateTotal("UpdatePlannedDynamicFields","txtUpdateTotalPlanned");$("#lblUpdateVarianceCount_"+n).text(parseInt($("#txtUpdateActiveCount_"+n).val()||0)+parseInt($("#txtUpdateInactiveCount_"+n).val()||0)-parseInt($("#txtUpdatePlannedCount_"+n).val()||0))});$(".UpdateActiveDynamicFields").keyup(function(){var n=$(this).prop("id").replace("txtUpdateActiveCount_","");objOrgGroupListJS.CalculateTotal("UpdateActiveDynamicFields","txtUpdateTotalActive");$("#lblUpdateVarianceCount_"+n).text(parseInt($("#txtUpdateActiveCount_"+n).val()||0)+parseInt($("#txtUpdateInactiveCount_"+n).val()||0)-parseInt($("#txtUpdatePlannedCount_"+n).val()||0))});$(".UpdateInactiveDynamicFields").keyup(function(){var n=$(this).prop("id").replace("txtUpdateInactiveCount_","");objOrgGroupListJS.CalculateTotal("UpdateInactiveDynamicFields","txtUpdateTotalInactive");$("#lblUpdateVarianceCount_"+n).text(parseInt($("#txtUpdateActiveCount_"+n).val()||0)+parseInt($("#txtUpdateInactiveCount_"+n).val()||0)-parseInt($("#txtUpdatePlannedCount_"+n).val()||0))});$(".UpdateVarianceDynamicFields").keyup(function(){var n=$(this).prop("id").replace("lblUpdateVarianceCount_","");objOrgGroupListJS.CalculateTotal("UpdateVarianceDynamicFields","txtUpdateTotalVariance");$("#lblUpdateVarianceCount_"+n).text(parseInt($("#txtUpdateActiveCount_"+n).val()||0)+parseInt($("#txtUpdateInactiveCount_"+n).val()||0)-parseInt($("#txtUpdatePlannedCount_"+n).val()||0))});$("#divUpdatePlantillaModal #btnAddNPRFFields").click(function(){$("#divUpdatePlantillaModal .NPRFNumberDynamicFields").addClass("required-field");$("#divUpdatePlantillaModal .DateApprovedDynamicFields").addClass("required-field");var i=$("#divUpdatePlantillaModal #DivNPRFDynamicFields .required-field"),t=!0;i.each(function(){if($(this).val()=="")return $(this).focus(),t=!1,!1});t&&n.AddNPRFDynamicFields(0,0)});$("#divUpdatePlantillaModal #btnSave").click(function(){var n=!0,t=0,i=[],r,u;$("#divUpdatePlantillaModal .IsHeadDynamicFields").attr("disabled",!1);$("#divUpdatePlantillaModal .UpdatePlannedDynamicFields").each(function(n){i.push($("#divUpdatePlantillaModal #hdnUpdatePositionID_"+n).val()+"-"+$(this).val())});r=PositionPlannedOld.sort().toString();u=i.sort().toString();r!=u?($("#divUpdatePlantillaModal #divOrgGroupNPRFErrorMessage").html('<label class="errMessage"><li>'+MSG_REQUIRED_NPRF+"<\/li><\/label><br />"),$("#divUpdatePlantillaModal .NPRFNumberDynamicFields, .DateApprovedDynamicFields").addClass("errMessage"),n=!1,$("#divUpdatePlantillaModal .NPRFNumberDynamicFields").each(function(){var n=$(this).prop("id").replace("txtNPRFNumber_","");this.value!=""?$("#txtNPRFNumber_"+n).removeClass("errMessage"):($("#txtNPRFNumber_"+n).addClass("errMessage"),t++)}),$("#divUpdatePlantillaModal .Attachment_File").each(function(){var n=$(this).prop("id").replace("fileAttachment_","");this.value!=""?$("#fileAttachment_"+n).removeClass("errMessage"):($("#fileAttachment_"+n).addClass("errMessage"),t++)}),t==0&&$("#divUpdatePlantillaModal .NPRFNumberDynamicFields").length>0&&($("#divUpdatePlantillaModal #divOrgGroupNPRFErrorMessage").html(""),n=!0)):($("#divUpdatePlantillaModal #divOrgGroupNPRFErrorMessage").html(""),$("#divUpdatePlantillaModal .NPRFNumberDynamicFields, .DateApprovedDynamicFields").removeClass("errMessage"));n&$("#divUpdatePlantillaModal .UpdatePlannedDynamicFields").length>0?ModalConfirmation(MODAL_HEADER,MSG_CONFIRM,"objEMSCommonJS.PostAjax(true                         , OrgGroupPlantillaCountUpdateURL                         , objOrgGroupUpdatePlantillaJS.GetFormData()                         , '#divUpdatePlantillaModal #divOrgGroupErrorMessage'                         , '#divUpdatePlantillaModal #btnSave'                         , objOrgGroupUpdatePlantillaJS.EditSuccessFunction);","function"):objEMSCommonJS.ChangeTab($(".tablinks:nth-child(2)"),"divUpdatePlantillaModal #tabOrgGroupNPRF")})},GetFormData:function(){$("#divUpdatePlantillaModal .Attachment_File").each(function(n){$(this).prop("name","NPRFList["+n+"].File")});var n=new FormData($("#frmOrgGroupPlantillaCountUpdate").get(0));return $("#divUpdatePlantillaModal .NPRFNumberDynamicFields").each(function(t){$(this).val()!=""&&(n.append("NPRFList["+t+"].OrgGroupID",$("#hdnUpdateOrgGroupID_0").val()),n.append("NPRFList["+t+"].NPRFNumber",$(this).val()))}),n},AddNPRFDynamicFields:function(){var t=$("#divUpdatePlantillaModal .NPRFDynamicFields:last").prop("id"),n=parseInt(t==undefined?0:t.replace("NPRFDynamicFields_",""))+1;$("#divUpdatePlantillaModal #DivNPRFDynamicFields").append('<div class="form-group form-fields NPRFDynamicFields" id="NPRFDynamicFields_'+n+'">                    <div class="col-md-2-5 text-align-center no-padding">                        <input type="text" id="txtNPRFNumber_'+n+'" class="form-control NPRFNumberDynamicFields" title="NPRFNumber">                    <\/div>                    <div class="col-md-3 no-padding">                        <input type="file" id="fileAttachment_'+n+'" class="form-control Attachment_File" title="Attachment" accept=".pdf,.doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document">                    <\/div>                    <div class="col-md-2-5 no-padding">                    <\/div>                    <div class="col-md-0-5 text-align-center no-padding">                        <span class="btn-glyph-dynamic glyphicon glyphicon-trash"                         onclick="ModalConfirmation(MODAL_HEADER, MSG_CONFIRM_DELETE_SINGLE, &quot;objOrgGroupEditJS.RemoveDynamicFields(\'#NPRFDynamicFields_'+n+"')&quot;, &quot;function&quot;);\"><\/span>                    <\/div>                  <\/div>")},LoadOrgGroupNPRF:function(){var i=this,n,t;$("#divUpdatePlantillaModal #DivNPRFList").html("");$("#divUpdatePlantillaModal #DivNPRFDynamicFields").html("");n={OrgGroupID:$("#hdnUpdateOrgGroupID_0").val()};t=function(n){var i=function(n,t){$("#divUpdatePlantillaModal #DivNPRFList").append('<div class="form-group form-fields NPRFListFields" id="NPRFListFields'+t+'">                            <div class="col-md-2-5 text-align-center no-padding">                                <input type="text" id="lblNPRFNumber_'+t+'" value="'+n.NPRFNumber+'" class="form-control" title="NPRFNumber" readonly>                            <\/div>                            <div class="col-md-3 no-padding">                                <label class="control-label block-label">'+n.SourceFile+'<\/label>                                <input type="hidden" id="lblServerFile_ '+t+'" value="'+n.ServerFile+'" class="form-control">                                <input type="hidden" id="lblSourceFile_ '+t+'" value="'+n.SourceFile+'" class="form-control">                            <\/div>                            <div class="col-md-2-5 no-padding">                                <label class="control-label block-label">'+n.UploadedBy+"<br> Timestamp: "+n.Timestamp+'<\/label>                            <\/div>                            <div class="col-md-0-5 no-padding">                                <span class="btn-glyph-dynamic glyphicon glyphicon-download-alt" onclick="objEMSCommonJS.DownloadAttachment(CheckFileIfExistsURL, \'PlantillaService_OrgGroup_Attachment_Path\',\''+n.ServerFile+"', '"+n.SourceFile+"')\"><\/span>                            <\/div>                          <\/div>")},t=1;$(n.Result).each(function(n,r){i(r,t);t++})};objEMSCommonJS.GetAjax(GetOrgGroupNPRFURL,n,"",t)},RemoveDynamicFields:function(n){$(n).remove();ModalAlert(MODAL_HEADER,MSG_SUCCESS_DELETE_REC)}};objOrgGroupUpdatePlantillaJS.Initialize()});
