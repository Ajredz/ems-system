var objCountListJS;const CountListURL=window.location.pathname+"?handler=List",OrgGroupAutoCompleteURL=window.location.pathname+"?handler=OrgGroupByOrgTypeAutoComplete",PositionAutoCompleteURL=window.location.pathname+"?handler=PositionAutoComplete",GetCheckExportCountByOrgTypeURL=window.location.pathname+"?handler=CheckExportCountByOrgType",DownloadExportCountByOrgTypeURL=window.location.pathname+"?handler=DownloadExportCountByOrgType";$(document).ready(function(){objCountListJS={Initialize:function(){var n=this,t;n.ElementBinding();t={OrgType:localStorage.PlantillaCountListOrgType||"",ScopeOrgType:$("#hdnOrgListFilter").val(),ScopeOrgGroupDelimited:localStorage.PlantillaCountListScopeOrgGroupDelimited,OrgGroupDelimited:localStorage.PlantillaCountListOrgGroupDelimited,PositionDelimited:localStorage.PlantillaCountListPositionDelimited,PlannedMin:localStorage.PlantillaCountListPlannedMin,PlannedMax:localStorage.PlantillaCountListPlannedMax,ActiveMin:localStorage.PlantillaCountListActiveMin,ActiveMax:localStorage.PlantillaCountListActiveMax,InactiveMin:localStorage.PlantillaCountListInactiveMin,InactiveMax:localStorage.PlantillaCountListInactiveMax,VarianceMin:localStorage.PlantillaCountListVarianceMin,VarianceMax:localStorage.PlantillaCountListVarianceMax,IsExport:!1};n.LoadJQGrid(t);n.GetLocalStorage()},ElementBinding:function(){var n=this;NumberOnlyWithNegative($("#txtFilterPlannedMin, #txtFilterPlannedMax, #txtFilterActiveMin, #txtFilterActiveMax, #txtFilterInactiveMin, #txtFilterInactiveMax, #txtFilterVarianceMin, #txtFilterVarianceMax"));$("#btnSearch").click(function(){$("#divPlantillaCountErrorMessage").html("");$("#ddlOrgType").removeClass("errMessage");var t={OrgType:$("#ddlOrgType").val(),ScopeOrgType:$("#hdnOrgListFilter").val(),ScopeOrgGroupDelimited:objEMSCommonJS.GetMultiSelectList("multiSelectedScopeOrgGroup").value,OrgGroupDelimited:objEMSCommonJS.GetMultiSelectList("multiSelectedOrgGroup").value,PositionDelimited:objEMSCommonJS.GetMultiSelectList("multiSelectedPosition").value,PlannedMin:$("#txtFilterPlannedMin").val(),PlannedMax:$("#txtFilterPlannedMax").val(),ActiveMin:$("#txtFilterActiveMin").val(),ActiveMax:$("#txtFilterActiveMax").val(),InactiveMin:$("#txtFilterInactiveMin").val(),InactiveMax:$("#txtFilterInactiveMax").val(),VarianceMin:$("#txtFilterVarianceMin").val(),VarianceMax:$("#txtFilterVarianceMax").val(),IsExport:!1};n.SetLocalStorage();ResetJQGridState("tblPlantillaCountList");n.LoadJQGrid(t)});$("#btnReset").click(function(){$("div.filterFields input").val("");$("div.filterFields select").val("");$("div.filterFields input[type='checkbox']").prop("checked",!0);$("#multiSelectedScopeOrgGroup").html("");$("#multiSelectedOrgGroup").html("");$("#multiSelectedPosition").html("");$("#btnSearch").click()});objEMSCommonJS.BindFilterMultiSelectAutoComplete("txtFilterScopeOrgGroup",OrgGroupAutoCompleteURL+"&OrgType="+$("#hdnOrgListFilter").val(),20,"multiSelectedScopeOrgGroup");$("#ddlOrgType").change(function(){$("#txtFilterOrgGroup").prop("autocomplete")=="off"&&($("#txtFilterOrgGroup").autocomplete("destroy"),$("#txtFilterOrgGroup").removeData("autocomplete"));objEMSCommonJS.BindFilterMultiSelectAutoComplete("txtFilterOrgGroup",OrgGroupAutoCompleteURL+"&OrgType="+$("#ddlOrgType").val(),20,"multiSelectedOrgGroup")});(localStorage.PlantillaCountListOrgType||"")!=""&&objEMSCommonJS.BindFilterMultiSelectAutoComplete("txtFilterOrgGroup",OrgGroupAutoCompleteURL+"&OrgType="+localStorage.PlantillaCountListOrgType,20,"multiSelectedOrgGroup");objEMSCommonJS.BindFilterMultiSelectAutoComplete("txtFilterPosition",PositionAutoCompleteURL,20,"multiSelectedPosition");$("#btnExport").click(function(){ModalConfirmation(MODAL_HEADER,MSG_CONFIRM,"objCountListJS.ExportFunction()","function")})},ExportFunction:function(){var n,t;$("#divPlantillaCountErrorMessage").html("");$("#ddlOrgType").removeClass("errMessage");n="&sidx="+$("#tblPlantillaCountList").jqGrid("getGridParam","sortname")+"&sord="+$("#tblPlantillaCountList").jqGrid("getGridParam","sortorder")+"&OrgType="+$("#ddlOrgType").val()+"&ScopeOrgType="+$("#hdnOrgListFilter").val()+"&ScopeOrgGroupDelimited="+objEMSCommonJS.GetMultiSelectList("multiSelectedScopeOrgGroup").value+"&OrgGroupDelimited="+objEMSCommonJS.GetMultiSelectList("multiSelectedOrgGroup").value+"&PositionDelimited="+objEMSCommonJS.GetMultiSelectList("multiSelectedPosition").value+"&PlannedMin="+$("#txtFilterPlannedMin").val()+"&PlannedMax="+$("#txtFilterPlannedMax").val()+"&ActiveMin="+$("#txtFilterActiveMin").val()+"&ActiveMax="+$("#txtFilterActiveMax").val()+"&InactiveMin="+$("#txtFilterInactiveMin").val()+"&InactiveMax="+$("#txtFilterInactiveMax").val()+"&VarianceMin="+$("#txtFilterVarianceMin").val()+"&VarianceMax="+$("#txtFilterVarianceMax").val();($("#ddlOrgType").val()||"")!=""?(t=function(t){t.IsSuccess?(window.location=DownloadExportCountByOrgTypeURL+n,$("#divModal").modal("hide")):ModalAlert(MODAL_HEADER,t.Result)},objEMSCommonJS.GetAjax(GetCheckExportCountByOrgTypeURL+n,{},"#btnExport",t,null,!0)):($("#divPlantillaCountErrorMessage").html('<label class="errMessage"><li>'+REQ_HIGHLIGHTED_FIELDS+"<\/li><\/label><br />"),$("#ddlOrgType").addClass("errMessage"))},LoadJQGrid:function(n){var r=this,t,i;Loading(!0);t=localStorage.getItem("tblPlantillaCountList")==""?"":$.parseJSON(localStorage.getItem("tblPlantillaCountList"));i=function(){var n=$(".jqgfirstrow").height();$(".jqgfirstrow td .filterFields").each(function(){$(this).appendTo("#filterFieldsContainer")});$(".jqgfirstrow").css({height:n+"px"});$("div.filterFields").unbind("keyup");$("div.filterFields").keyup(function(n){n.keyCode=="13"&&$("#btnSearch").click()})};i();$("#tblPlantillaCountList").jqGrid("GridUnload");$("#tblPlantillaCountList").jqGrid("GridDestroy");$("#tblPlantillaCountList").jqGrid({url:CountListURL,postData:n,sortname:t==null?"":t.sortname,sortorder:t==null?"":t.sortorder,selrow:t==null?"":t.selrow,pageNumber:t==null?1:t.page,rowNum:t==null?10:t.rowNum,datatype:"json",mtype:"GET",colNames:["","Filter By Region","Org Group","Position","Planned","Active","Inactive","Variance"],colModel:[{hidden:!0},{hidden:!0,name:"ScopeOrgGroup",index:"ScopeOrgGroup",editable:!0,align:"left",sortable:!1},{name:"OrgGroup",index:"OrgGroup",editable:!0,align:"left",sortable:!0},{name:"Position",index:"Position",editable:!0,align:"left",sortable:!0},{name:"PlannedCount",index:"PlannedCount",editable:!0,align:"center"},{name:"ActiveCount",index:"ActiveCount",editable:!0,align:"center"},{name:"InactiveCount",index:"InactiveCount",editable:!0,align:"center"},{name:"VarianceCount",index:"VarianceCount",editable:!0,align:"center"},],toppager:$("#divPager"),rowList:SetRowList(),loadonce:!1,viewrecords:!0,jsonReader:{root:"rows",page:"page",total:"total",records:"records",repeatitems:!1},emptyrecords:"No records to display",multiselect:!1,rowNumbers:!0,width:"100%",height:"100%",sortable:!0,loadComplete:function(n){if(Loading(!1),n.IsSuccess!=undefined&&(n.IsSuccess||($("#divErrorMessage").html(""),ModalAlert(MODAL_HEADER,n.Result))),n.rows!=null){if(window.location.pathname.indexOf("admin")>=0&&$("#tblPlantillaCountList").jqGrid("showCol",["ScopeOrgGroup"]),n.rows.length>0)for(var t=0;t<n.rows.length;t++);AutoSizeColumnJQGrid("tblPlantillaCountList",n);$("#filterFieldsContainer .filterFields").each(function(n){$(this).appendTo(".jqgfirstrow td:nth-child("+(n+2)+")")});$("#tblPlantillaCountList .jqgrid-id-link").click(function(){$("#divCountModal").modal("show")})}localStorage.CountListFilterOption!=undefined&&$("#chkFilter").prop("checked",JSON.parse(localStorage.CountListFilterOption));objCountListJS.ShowHideFilter();$("#chkFilter").on("change",function(){objCountListJS.ShowHideFilter();localStorage.CountListFilterOption=$("#chkFilter").is(":checked")});$("table tr.jqgfirstrow td").each(function(n){var t=n+1;$("table .jqgfirstrow td:nth-child("+t+")").find("input[type='search']").length&&$("table .jqgfirstrow td:nth-child("+t+") input").val()!=""&&($(".ui-jqgrid-htable tr th:nth-child("+t+")").addClass("filtered"),$(".ui-jqgrid-htable tr th:nth-child("+t+").filtered div").find("span.glyphicon-table-header").length==0&&$(".ui-jqgrid-htable tr th:nth-child("+t+").filtered div").prepend('<span class="glyphicon glyphicon-filter glyphicon-table-header"><\/span>'));$("table .jqgfirstrow td:nth-child("+t+")").find("input[type='number']").length&&$("table .jqgfirstrow td:nth-child("+t+") input").val()!=""&&($(".ui-jqgrid-htable tr th:nth-child("+t+")").addClass("filtered"),$(".ui-jqgrid-htable tr th:nth-child("+t+").filtered div").find("span.glyphicon-table-header").length==0&&$(".ui-jqgrid-htable tr th:nth-child("+t+").filtered div").prepend('<span class="glyphicon glyphicon-filter glyphicon-table-header"><\/span>'));$("table .jqgfirstrow td:nth-child("+t+")").find("div.multiselect-control").length&&$("table .jqgfirstrow td:nth-child("+t+") div.multiselect-control").text()!=""&&($(".ui-jqgrid-htable tr th:nth-child("+t+")").addClass("filtered"),$(".ui-jqgrid-htable tr th:nth-child("+t+").filtered div").find("span.glyphicon-table-header").length==0&&$(".ui-jqgrid-htable tr th:nth-child("+t+").filtered div").prepend('<span class="glyphicon glyphicon-filter glyphicon-table-header"><\/span>'))})},loadError:function(n){ModalAlert(MODAL_HEADER,n.responseText);Loading(!1)},beforeRequest:function(){GetJQGridState("tblPlantillaCountList");i()}}).navGrid("#divPager",{edit:!1,add:!1,del:!1,search:!1,refresh:!1});jQuery(".ui-pg-selbox").closest("select").before('<label class="ui-row-label">Show<\/label>');jQuery(".ui-row-label").closest("label").before('<label class="ui-row-label" id="lblFilter">Show Filter<\/label>');jQuery("#lblFilter").after('<input type="checkbox" id="chkFilter" style="margin-right:15px; margin-top: 5px;"><\/div>')},SetLocalStorage:function(){localStorage.PlantillaCountListOrgType=$("#ddlOrgType").val();localStorage.PlantillaCountListScopeOrgGroupDelimited=objEMSCommonJS.GetMultiSelectList("multiSelectedScopeOrgGroup").value;localStorage.PlantillaCountListScopeOrgGroupDelimitedText=objEMSCommonJS.GetMultiSelectList("multiSelectedScopeOrgGroup").text;localStorage.PlantillaCountListOrgGroupDelimited=objEMSCommonJS.GetMultiSelectList("multiSelectedOrgGroup").value;localStorage.PlantillaCountListOrgGroupDelimitedText=objEMSCommonJS.GetMultiSelectList("multiSelectedOrgGroup").text;localStorage.PlantillaCountListPositionDelimited=objEMSCommonJS.GetMultiSelectList("multiSelectedPosition").value;localStorage.PlantillaCountListPositionDelimitedText=objEMSCommonJS.GetMultiSelectList("multiSelectedPosition").text;localStorage.PlantillaCountListPlannedMin=$("#txtFilterPlannedMin").val();localStorage.PlantillaCountListPlannedMax=$("#txtFilterPlannedMax").val();localStorage.PlantillaCountListActiveMin=$("#txtFilterActiveMin").val();localStorage.PlantillaCountListActiveMax=$("#txtFilterActiveMax").val();localStorage.PlantillaCountListInactiveMin=$("#txtFilterInactiveMin").val();localStorage.PlantillaCountListInactiveMax=$("#txtFilterInactiveMax").val();localStorage.PlantillaCountListVarianceMin=$("#txtFilterVarianceMin").val();localStorage.PlantillaCountListVarianceMax=$("#txtFilterVarianceMax").val()},GetLocalStorage:function(){$("#ddlOrgType").val(localStorage.PlantillaCountListOrgType);objEMSCommonJS.SetMultiSelectList("multiSelectedOrgGroup","PlantillaCountListOrgGroupDelimited","PlantillaCountListOrgGroupDelimitedText");objEMSCommonJS.SetMultiSelectList("multiSelectedScopeOrgGroup","PlantillaCountListScopeOrgGroupDelimited","PlantillaCountListScopeOrgGroupDelimitedText");objEMSCommonJS.SetMultiSelectList("multiSelectedPosition","PlantillaCountListPositionDelimited","PlantillaCountListPositionDelimitedText");$("#txtFilterPlannedMin").val(localStorage.PlantillaCountListPlannedMin);$("#txtFilterPlannedMax").val(localStorage.PlantillaCountListPlannedMax);$("#txtFilterActiveMin").val(localStorage.PlantillaCountListActiveMin);$("#txtFilterActiveMax").val(localStorage.PlantillaCountListActiveMax);$("#txtFilterInactiveMin").val(localStorage.PlantillaCountListInactiveMin);$("#txtFilterInactiveMax").val(localStorage.PlantillaCountListInactiveMax);$("#txtFilterVarianceMin").val(localStorage.PlantillaCountListVarianceMin);$("#txtFilterVarianceMax").val(localStorage.PlantillaCountListVarianceMax)},ShowHideFilter:function(){$("#chkFilter").is(":checked")?$(".jqgfirstrow .filterFields").show():$("#chkFilter").is(":not(:checked)")&&$(".jqgfirstrow .filterFields").hide()}};objCountListJS.Initialize()});