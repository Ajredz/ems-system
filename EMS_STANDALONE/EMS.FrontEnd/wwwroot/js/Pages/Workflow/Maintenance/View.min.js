var objWorkflowViewJS,ApprovalRoleListBoxOptions=[],ResultTypeDropDownOptions=[];$(document).ready(function(){objWorkflowViewJS={ID:$("#hdnID").val(),Initialize:function(){var n=this;n.ElementBinding();$(".reqField").addClass("unreqField");$(".reqField").removeClass("reqField");$(".required-field").removeClass("required-field");$("#btnAddWorkflowStepFields").hide();n.GetApprovalRoleListBoxOptions();n.GetResultTypeDropDownOptions();n.LoadWorkflowStep()},DeleteSuccessFunction:function(){$("#btnSearch").click();$("#divWorkflowModal").modal("hide")},ElementBinding:function(){var n=this;$("#btnDelete").click(function(){ModalConfirmation(MODAL_HEADER,MSG_CONFIRM_DELETE_SINGLE,"objEMSCommonJS.PostAjax(false                     , WorkflowDeleteURL + '?ID=' + objWorkflowViewJS.ID                    , {}                     , '#divWorkflowErrorMessage'                     , '#btnDelete'                     , objWorkflowViewJS.DeleteSuccessFunction);","function")});$("#btnEdit").click(function(){LoadPartial(WorkflowEditURL+"?ID="+objWorkflowViewJS.ID,"divWorkflowBodyModal")})},GetApprovalRoleListBoxOptions:function(){var n=function(n){$(n.Result).each(function(n,t){ApprovalRoleListBoxOptions.push({Value:t.Value,Text:t.Text})})};objEMSCommonJS.GetAjax(ViewApproverRoleDropDownURL,{},"",n)},GetResultTypeDropDownOptions:function(){var t=this,n=function(n){$(n.Result).each(function(n,t){ResultTypeDropDownOptions.push({Value:t.Value,Text:t.Description})})};objEMSCommonJS.GetAjax(ViewResultTypeDropDownURL,{},"",n)},AddWorkflowStepDynamicFields:function(){var i=this,t=$(".WorkflowStepDynamicFields:last").prop("id"),n=parseInt(t==undefined?0:t.replace("WorkflowStepDynamicFields_",""))+1,r=n!=1?parseInt($("#txtOrder_"+(n-1)).val())+1:1;$("#DivWorkflowStepDynamicFields").append('<div class="form-group form-fields WorkflowStepDynamicFields" id="WorkflowStepDynamicFields_'+n+'">    <div class="col-md-0-75 no-padding">        <input id="txtOrder_'+n+'" value="'+r+'" class="form-control OrderDynamicFields text-amount" maxlength="17" title="Order" readonly>    <\/div>    <div class="col-md-2 no-padding">        <input type="text" id="txtStepCode_'+n+'" class="form-control StepCodeDynamicFields" title="Step Code">    <\/div>    <div class="col-md-2-5 no-padding">        <input type="text" id="txtStepDescription_'+n+'" class="form-control StepDescriptionDynamicFields" title="Step Description">    <\/div>    <div class="col-md-1-5 no-padding">        <select id="ddlResultType_'+n+'" title="Result Type" class="form-control ResultTypeDynamicFields"><option value = "">- Select an item -<\/option><\/select>    <\/div>    <div class="col-md-0-75 text-align-center no-padding">        <input type="checkbox" id="chkIsRequired_'+n+'" class="IsRequiredDynamicFields" title="IsRequired">    <\/div>    <div class="col-md-0-75 text-align-center no-padding">        <input type="checkbox" id="chkAllowBackflow_'+n+'" class="AllowBackflowDynamicFields" title="Allow Back Flow">    <\/div>    <div class="col-md-0-75 text-align-center no-padding">        <input type="checkbox" id="chkSendEmailToRequester_'+n+'" class="SendEmailToRequesterDynamicFields" title="Send Email to Requester">    <\/div>    <div class="col-md-0-75 text-align-center no-padding">        <input type="checkbox" id="chkSendEmailToApprover_'+n+'" class="SendEmailToApproverDynamicFields" title="Send Email to Approver">    <\/div>    <div class="col-md-0-75 no-padding">        <input type="text" id="txtTATDays_'+n+'" class="form-control TATDaysDynamicFields" title="TAT Days">    <\/div>    <div class="col-md-0-75 text-align-center no-padding">        <label id="btnApprover_'+n+'">           <span class="btn-glyph-dynamic glyphicon glyphicon-list" title="Click to view approver role"><\/span>        <\/label>    <\/div><\/div>');$('input[type="checkbox"]').prop("disabled",!0);$(".ResultTypeDynamicFields").prop("disabled",!0);objEMSCommonJS.PopulateDropDown("#ddlResultType_"+n,ResultTypeDropDownOptions);i.AddApproverRoleDynamicFields(n);$("#btnApprover_"+n).click(function(){$("#ApproverRoleDynamicFields_"+n).show();$("#divWorkflowApprovalModal").modal("show")})},AddApproverRoleDynamicFields:function(n){$("#DivApproverRoleDynamicFields").append('<div class="form-group form-fields ApproverRoleDynamicFields" id="ApproverRoleDynamicFields_'+n+'">   <div class="col-md-5 listOne">       <input type="text" id="" class="form-control listbox txtSearchBoxOne" placeholder="Search here..."/>       <select id="ddlListOne_'+n+'" class="form-control listbox" size="10"><\/select>   <\/div>   <div class="col-md-2 text-align-center listboxbutton">       <br/>       <br/>       <button type="button" id="btnMoveToListTwoAll_'+n+'" class="btnBlue formbtn btn-transfer">>><\/button>       <button type="button" id="btnMoveToListTwo_'+n+'" class="btnBlue formbtn btn-transfer">><\/button>       <button type="button" id="btnMoveToListOne_'+n+'" class="btnBlue formbtn btn-transfer"><<\/button>       <button type="button" id="btnMoveToListOneAll_'+n+'" class="btnBlue formbtn btn-transfer"><<<\/button>   <\/div>   <div class="col-md-5 listTwo">       <input type="text" id="" class="form-control listbox txtSearchBoxTwo" placeholder="Search here..."/>       <select id="ddlListTwo_'+n+'" class="form-control listbox required-field RoleIDDynamicFields_'+n+'" size="10"><\/select>   <\/div><\/div>');$(".listOne, .listboxbutton").hide();$(".listTwo").removeClass("col-md-5");$(".listTwo").addClass("col-md-12");$("#divWorkflowApprovalModal .modal-dialog").attr("style","width: 20%");$(".ApproverRoleDynamicFields").hide();$("#divWorkflowApprovalHeaderModal .close").click(function(){$("#ApproverRoleDynamicFields_"+n).hide()})},LoadWorkflowStep:function(){var i=this,n,t;$("#DivWorkflowStepDynamicFields").html("");n={handler:"Workflow",ID:objWorkflowViewJS.ID};t=function(n){var r=function(n,t){i.AddWorkflowStepDynamicFields();$("#txtOrder_"+t).val(n.Order);$("#txtStepCode_"+t).val(n.StepCode);$("#txtStepDescription_"+t).val(n.StepDescription);$("#ddlResultType_"+t).val(n.ResultType);$("#chkIsRequired_"+t).val(n.IsRequired);$("#chkIsRequired_"+t).attr("checked",n.IsRequired);$("#chkAllowBackflow_"+t).val(n.AllowBackflow);$("#chkAllowBackflow_"+t).attr("checked",n.AllowBackflow);$("#chkSendEmailToRequester_"+t).val(n.SendEmailToRequester);$("#chkSendEmailToRequester_"+t).attr("checked",n.SendEmailToRequester);$("#chkSendEmailToApprover_"+t).val(n.SendEmailToApprover);$("#chkSendEmailToApprover_"+t).attr("checked",n.SendEmailToApprover);$("#txtTATDays_"+t).val(n.TATDays);$("#txtOrder_"+t).attr("readonly",!0);$("#txtStepCode_"+t).attr("readonly",!0);$("#txtStepDescription_"+t).attr("readonly",!0);$("#ddlResultType_"+t).attr("readonly",!0);$("#chkIsRequired_"+t).attr("readonly",!0);$("#chkAllowBackflow_"+t).attr("readonly",!0);$("#chkSendEmailToRequester_"+t).attr("readonly",!0);$("#chkSendEmailToApprover_"+t).attr("readonly",!0);$("#txtTATDays_"+t).attr("readonly",!0);$("#ddlListTwo_"+t).empty();$(n.WorkflowStepApproverList).each(function(n,i){$(ApprovalRoleListBoxOptions).each(function(n,r){r.Value==i.RoleID&&$("#ddlListTwo_"+t).append($("<option/>",{value:r.Value,text:r.Text}))})})},t=1;$(n.Result.WorkflowStepList).each(function(n,i){r(i,t);t++})};objEMSCommonJS.GetAjax(WorkflowViewURL,n,"",t)}};objWorkflowViewJS.Initialize()});
