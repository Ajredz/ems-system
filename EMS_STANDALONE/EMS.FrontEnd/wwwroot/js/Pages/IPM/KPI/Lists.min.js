var objKPIListJS;const KPIListURL="/IPM/KPI?handler=List",KPIAddURL="/IPM/KPI/Add",KPIViewURL="/IPM/KPI/View",KPIEditURL="/IPM/KPI/Edit",KPIDeleteURL="/IPM/KPI/Delete",KPIAddPostURL="/IPM/KPI/Add",KPIEditPostURL="/IPM/KPI/Edit",GetCheckExportListURL="/IPM/KPI?handler=CheckExportList",DownloadExportListURL="/IPM/KPI?handler=DownloadExportList",UploadKPIURL="/IPM/KPI/Upload?handler=UploadKPIList",DownloadKPIFormURL="/IPM/KPI?handler=DownloadKPITemplate&ID=1",KRAGroupAddURL="/IPM/KRAGroup/Add",KRAGroupAddPostURL="/IPM/KRAGroup/Add",GetKRAGroupDropdownURL="/IPM/KPI?handler=KRAGroupDropdown",KRASubGroupAddURL="/IPM/KRASubGroup/Add",KRASubGroupAddPostURL="/IPM/KRASubGroup/Add",GetKRASubGroupDropdownURL="/IPM/KPI?handler=KRASubGroupDropdown",KRATypeDropDownURL="/IPM/KPI?handler=ReferenceValue&RefCode=KRA_TYPE",KRAGroupAutoCompleteURL="/IPM/KPI?handler=KRAGroupAutoComplete",KRASubGroupAutoCompleteURL="/IPM/KPI?handler=KRASubGroupAutoComplete",KPITypeDropDownURL="/IPM/KPI?handler=ReferenceValue&RefCode=KPI_TYPE",SourceTypeDropDownURL="/IPM/KPI?handler=ReferenceValue&RefCode=KPI_SOURCE_TYPE";$(document).ready(function(){objKPIListJS={Initialize:function(){var n,t;$("#divUploadModal").css("width","50%");$("#divUploadModal .modal-header").mousedown(handle_mousedown);n=this;n.ElementBinding();t={ID:localStorage.IPMKPIListID,Code:localStorage.IPMKPIListCode,KRATypeDelimited:localStorage.IPMKPIListKRATypeDelimited,KRAGroup:localStorage.IPMKPIListKRAGroup,KRASubGroup:localStorage.IPMKPIListKRASubGroup,Name:localStorage.IPMKPIListName,OldKPICode:localStorage.IPMKPIListOldKPICode,KPITypeDelimited:localStorage.IPMKPIListKPITypeDelimited,SourceTypeDelimited:localStorage.IPMKPIListSourceTypeDelimited};n.LoadJQGrid(t);n.GetLocalStorage()},ElementBinding:function(){var n=this;NumberOnly($("#txtFilterID"));$("#btnSearch").click(function(){var t={ID:$("#txtFilterID").val(),Code:$("#txtFilterCode").val(),KRATypeDelimited:objEMSCommonJS.GetMultiSelectList("multiSelectedKRAType").value,KRAGroup:objEMSCommonJS.GetMultiSelectList("multiSelectedKRAGroup").value,KRASubGroup:objEMSCommonJS.GetMultiSelectList("multiSelectedKRASubGroup").value,Name:$("#txtFilterName").val(),OldKPICode:$("#txtFilterOldCode").val(),KPITypeDelimited:objEMSCommonJS.GetMultiSelectList("multiSelectedKPIType").value,SourceTypeDelimited:objEMSCommonJS.GetMultiSelectList("multiSelectedSourceType").value};n.SetLocalStorage();ResetJQGridState("tblIPMKPIList");n.LoadJQGrid(t)});$("#btnReset").click(function(){$("div.filterFields input[type='search']").val("");$("div.filterFields select").val("");$("#multiSelectedKRAType").html("");$("#multiSelectedKRAGroup").html("");$("#multiSelectedKRASubGroup").html("");$("#multiSelectedKRATypeOption label, #multiSelectedKRATypeOption input").prop("title","add");$("#multiSelectedKRAGroupOption label, #multiSelectedKRAGroupOption input").prop("title","add");$("#multiSelectedKRASubGroupOption label, #multiSelectedKRASubGroupOption input").prop("title","add");$("#multiSelectedKPIType").html("");$("#multiSelectedKPITypeOption label, #multiSelectedKPITypeOption input").prop("title","add");$("#multiSelectedSourceType").html("");$("#multiSelectedSourceTypeOption label, #multiSelectedSourceTypeOption input").prop("title","add");$("div.filterFields input[type='checkbox']").prop("checked",!0);$("#btnSearch").click()});$("#btnAdd").click(function(){LoadPartial(KPIAddURL,"divKPIBodyModal");$("#divKPIModal").modal("show")});$("#btnUpload").click(function(){objKPIUploadJS.UploadModal(UploadKPIURL,"Upload KPI",DownloadKPIFormURL);$("#divModalErrorMessage").html("")});$("#btnExport").click(function(){ModalConfirmation(MODAL_HEADER,MSG_CONFIRM,"objKPIListJS.ExportFunction()","function")});objEMSCommonJS.BindFilterMultiSelectEnum("multiSelectedKRAType",KRATypeDropDownURL);objEMSCommonJS.BindFilterMultiSelectEnum("multiSelectedKPIType",KPITypeDropDownURL);objEMSCommonJS.BindFilterMultiSelectEnum("multiSelectedSourceType",SourceTypeDropDownURL);objEMSCommonJS.BindFilterMultiSelectAutoComplete("txtFilterKRAGroup",KRAGroupAutoCompleteURL,20,"multiSelectedKRAGroup");objEMSCommonJS.BindFilterMultiSelectAutoComplete("txtFilterKRASubGroup",KRASubGroupAutoCompleteURL,20,"multiSelectedKRASubGroup")},ExportFunction:function(){var n="&sidx="+$("#tblIPMKPIList").jqGrid("getGridParam","sortname")+"&sord="+$("#tblIPMKPIList").jqGrid("getGridParam","sortorder")+"&ID="+$("#txtFilterID").val()+"&Code="+$("#txtFilterCode").val()+"&KRATypeDelimited="+objEMSCommonJS.GetMultiSelectList("multiSelectedKRAType").value+"&KRAGroup="+objEMSCommonJS.GetMultiSelectList("multiSelectedKRAGroup").value+"&KRASubGroup="+objEMSCommonJS.GetMultiSelectList("multiSelectedKRASubGroup").value+"&Name="+$("#txtFilterName").val()+"&OldKPICode="+$("#txtFilterOldCode").val()+"&KPITypeDelimited="+objEMSCommonJS.GetMultiSelectList("multiSelectedKPIType").value+"&SourceTypeDelimited="+objEMSCommonJS.GetMultiSelectList("multiSelectedSourceType").value,t=function(t){t.IsSuccess==!0?(window.location=DownloadExportListURL+n,$("#divModal").modal("hide")):ModalAlert(MODAL_HEADER,t.Result)};objEMSCommonJS.GetAjax(GetCheckExportListURL+n,{},"#btnExport",t,null,!0)},LoadJQGrid:function(n){var r=this,t,i;Loading(!0);t=localStorage.getItem("tblIPMKPIList")==""?"":$.parseJSON(localStorage.getItem("tblIPMKPIList"));i=function(){var n=$(".jqgfirstrow").height();$(".jqgfirstrow td .filterFields").each(function(){$(this).appendTo("#filterFieldsContainer")});$(".jqgfirstrow").css({height:n+"px"});$("div.filterFields").unbind("keyup");$("div.filterFields").keyup(function(n){n.keyCode=="13"&&$("#btnSearch").click()})};i();$("#tblIPMKPIList").jqGrid("GridUnload");$("#tblIPMKPIList").jqGrid("GridDestroy");$("#tblIPMKPIList").jqGrid({url:KPIListURL,postData:n,sortname:t==null?"":t.sortname,sortorder:t==null?"":t.sortorder,selrow:t==null?"":t.selrow,pageNumber:t==null?1:t.page,rowNum:t==null?10:t.rowNum,datatype:"json",mtype:"GET",colNames:["","ID","Code","KRA Type","KRA Group","KRA Sub Group","KPI Name","Old KPI Code","KPI Type","Source Type"],colModel:[{hidden:!0},{width:60,key:!0,name:"ID",index:"ID",align:"center",sortable:!0,formatter:objKPIListJS.ViewLink},{width:60,name:"Code",index:"Code",editable:!0,align:"left"},{width:150,name:"KRAType",index:"KRAType",editable:!0,align:"left"},{width:150,name:"KRAGroup",index:"KRAGroup",editable:!0,align:"left"},{width:150,name:"KRASubGroup",index:"KRASubGroup",editable:!0,align:"left"},{width:250,name:"Name",index:"Name",editable:!0,align:"left"},{width:100,name:"OldKPICode",index:"OldKPICode",editable:!0,align:"left"},{width:100,name:"KPIType",index:"KPIType",editable:!0,align:"left",sortable:!1},{width:100,name:"SourceType",index:"SourceType",editable:!0,align:"left",sortable:!1},],toppager:$("#divPager"),rowList:SetRowList(),loadonce:!1,viewrecords:!0,jsonReader:{root:"rows",page:"page",total:"total",records:"records",repeatitems:!1},emptyrecords:"No records to display",multiselect:!1,rowNumbers:!0,width:"100%",height:"100%",sortable:!0,ondblClickRow:function(n,t){$("#tblIPMKPIList tr:nth-child("+(t+1)+") .jqgrid-id-link").click()},loadComplete:function(n){if(Loading(!1),n.IsSuccess!=undefined&&(n.IsSuccess||($("#divErrorMessage").html(""),ModalAlert(MODAL_HEADER,n.Result))),n.rows!=null){if(n.rows.length>0)for(var t=0;t<n.rows.length;t++);$("#filterFieldsContainer .filterFields").each(function(n){$(this).appendTo(".jqgfirstrow td:nth-child("+(n+2)+")")});$("#tblIPMKPIList .jqgrid-id-link").click(function(){$("#divKPIModal").modal("show")})}localStorage.KPIListFilterOption!=undefined&&$("#chkFilter").prop("checked",JSON.parse(localStorage.KPIListFilterOption));objKPIListJS.ShowHideFilter();$("#chkFilter").on("change",function(){objKPIListJS.ShowHideFilter();localStorage.KPIListFilterOption=$("#chkFilter").is(":checked")});$(".ui-jqgrid-bdiv").css({"min-height":"400px"});$("table tr.jqgfirstrow td").each(function(n){var t=n+1;$("table .jqgfirstrow td:nth-child("+t+")").find("input[type='search']").length&&$("table .jqgfirstrow td:nth-child("+t+") input").val()!=""&&($(".ui-jqgrid-htable tr th:nth-child("+t+")").addClass("filtered"),$(".ui-jqgrid-htable tr th:nth-child("+t+").filtered div").find("span.glyphicon-table-header").length==0&&$(".ui-jqgrid-htable tr th:nth-child("+t+").filtered div").prepend('<span class="glyphicon glyphicon-filter glyphicon-table-header"><\/span>'));$("table .jqgfirstrow td:nth-child("+t+")").find("input[type='number']").length&&$("table .jqgfirstrow td:nth-child("+t+") input").val()!=""&&($(".ui-jqgrid-htable tr th:nth-child("+t+")").addClass("filtered"),$(".ui-jqgrid-htable tr th:nth-child("+t+").filtered div").find("span.glyphicon-table-header").length==0&&$(".ui-jqgrid-htable tr th:nth-child("+t+").filtered div").prepend('<span class="glyphicon glyphicon-filter glyphicon-table-header"><\/span>'));$("table .jqgfirstrow td:nth-child("+t+")").find("div.multiselect-control").length&&$("table .jqgfirstrow td:nth-child("+t+") div.multiselect-control").text()!=""&&($(".ui-jqgrid-htable tr th:nth-child("+t+")").addClass("filtered"),$(".ui-jqgrid-htable tr th:nth-child("+t+").filtered div").find("span.glyphicon-table-header").length==0&&$(".ui-jqgrid-htable tr th:nth-child("+t+").filtered div").prepend('<span class="glyphicon glyphicon-filter glyphicon-table-header"><\/span>'))})},loadError:function(n){ModalAlert(MODAL_HEADER,n.responseText);Loading(!1)},beforeRequest:function(){GetJQGridState("tblIPMKPIList");i()}}).navGrid("#divPager",{edit:!1,add:!1,del:!1,search:!1,refresh:!1});jQuery(".ui-pg-selbox").closest("select").before('<label class="ui-row-label">Show<\/label>');jQuery(".ui-row-label").closest("label").before('<label class="ui-row-label" id="lblFilter">Show Filter<\/label>');jQuery("#lblFilter").after('<input type="checkbox" id="chkFilter" style="margin-right:15px; margin-top: 5px;"><\/div>')},SetLocalStorage:function(){localStorage.IPMKPIListID=$("#txtFilterID").val();localStorage.IPMKPIListCode=$("#txtFilterCode").val();localStorage.IPMKPIListKRATypeDelimited=objEMSCommonJS.GetMultiSelectList("multiSelectedKRAType").value;localStorage.IPMKPIListKRATypeDelimitedText=objEMSCommonJS.GetMultiSelectList("multiSelectedKRAType").text;localStorage.IPMKPIListKRAGroup=objEMSCommonJS.GetMultiSelectList("multiSelectedKRAGroup").value;localStorage.IPMKPIListKRAGroupText=objEMSCommonJS.GetMultiSelectList("multiSelectedKRAGroup").text;localStorage.IPMKPIListKRASubGroup=objEMSCommonJS.GetMultiSelectList("multiSelectedKRASubGroup").value;localStorage.IPMKPIListKRASubGroupText=objEMSCommonJS.GetMultiSelectList("multiSelectedKRASubGroup").text;localStorage.IPMKPIListName=$("#txtFilterName").val();localStorage.IPMKPIListOldKPICode=$("#txtFilterOldCode").val();localStorage.IPMKPIListKPITypeDelimited=objEMSCommonJS.GetMultiSelectList("multiSelectedKPIType").value;localStorage.IPMKPIListKPITypeDelimitedText=objEMSCommonJS.GetMultiSelectList("multiSelectedKPIType").text;localStorage.IPMKPIListSourceTypeDelimited=objEMSCommonJS.GetMultiSelectList("multiSelectedSourceType").value;localStorage.IPMKPIListSourceTypeDelimitedText=objEMSCommonJS.GetMultiSelectList("multiSelectedSourceType").text},GetLocalStorage:function(){$("#txtFilterID").val(localStorage.IPMKPIListID);$("#txtFilterCode").val(localStorage.IPMKPIListCode);objEMSCommonJS.SetMultiSelectList("multiSelectedKRAType","IPMKPIListKRATypeDelimited","IPMKPIListKRATypeDelimitedText");objEMSCommonJS.SetMultiSelectList("multiSelectedKRAGroup","IPMKPIListKRAGroup","IPMKPIListKRAGroupText");objEMSCommonJS.SetMultiSelectList("multiSelectedKRASubGroup","IPMKPIListKRASubGroup","IPMKPIListKRASubGroupText");$("#txtFilterName").val(localStorage.IPMKPIListName);$("#txtFilterOldCode").val(localStorage.IPMKPIListOldKPICode);objEMSCommonJS.SetMultiSelectList("multiSelectedKPIType","IPMKPIListKPITypeDelimited","IPMKPIListKPITypeDelimitedText");objEMSCommonJS.SetMultiSelectList("multiSelectedSourceType","IPMKPIListSourceTypeDelimited","IPMKPIListSourceTypeDelimitedText")},ViewLink:function(n,t,i){return"<a href=\"\" class='jqgrid-id-link' onclick=\"return LoadPartial('"+KPIViewURL+"?ID="+i.ID+"', 'divKPIBodyModal');\">"+objEMSCommonJS.JQGridIDFormat(i.ID)+"<\/a>"},ShowHideFilter:function(){$("#chkFilter").is(":checked")?$(".jqgfirstrow .filterFields").show():$("#chkFilter").is(":not(:checked)")&&$(".jqgfirstrow .filterFields").hide()}};objKPIListJS.Initialize()});