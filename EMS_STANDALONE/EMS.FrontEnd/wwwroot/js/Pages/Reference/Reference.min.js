var objReferenceJS;const ReferenceValueURL=window.location.pathname,ReferencePostURL=window.location.pathname+"?refcode=";$(document).ready(function(){objReferenceJS={Initialize:function(){var n=this;n.ElementBinding();n.AddReferenceValueDynamicFields()},ElementBinding:function(){var n=this;$("#ddlReferenceCode").change(function(){$("#ddlReferenceCode").val()!=""?objReferenceJS.LoadReferenceValues():($("#DivReferenceValueDynamicFields").html(""),objReferenceJS.AddReferenceValueDynamicFields())});$("#btnAddReferenceValueFields").click(function(){var i=$("#DivReferenceValueDynamicFields .required-field"),t=!0;i.each(function(){if($(this).val()=="")return $(this).focus(),t=!1,!1});t&&n.AddReferenceValueDynamicFields()});$("#btnSave").click(function(){objEMSCommonJS.ValidateBlankFields("#frmReference","#divReferenceErrorMessage",objReferenceJS.ValidateDuplicateFields)&&($(".ValueDynamicFields").each(function(n){$(this).prop("name","ReferenceValue["+n+"].Value")}),$(".DescriptionDynamicFields").each(function(n){$(this).prop("name","ReferenceValue["+n+"].Description")}),ModalConfirmation(MODAL_HEADER,MSG_CONFIRM,"objEMSCommonJS.PostAjax(true                         , ReferencePostURL + $('#ddlReferenceCode').val()                         , new FormData($('#frmReference').get(0))                         , '#divReferenceErrorMessage'                         , '#btnSave'                         , objReferenceJS.SaveSuccessFunction); ","function"))})},SaveSuccessFunction:function(){objReferenceJS.LoadReferenceValues()},AddReferenceValueDynamicFields:function(){var t=$(".ReferenceValueDynamicFields:last").prop("id"),n=parseInt(t==undefined?0:t.replace("ReferenceValueDynamicFields_",""))+1;$("#DivReferenceValueDynamicFields").append('<div class="form-group form-fields ReferenceValueDynamicFields" id="ReferenceValueDynamicFields_'+n+'">    <div class="col-md-4 no-padding">        <input id="txtValue_'+n+'" maxlength="20" class="form-control required-field ValueDynamicFields" title="Value">    <\/div>    <div class="col-md-7 no-padding">        <input id="txtDescription_'+n+'" maxlength="255" class="form-control required-field DescriptionDynamicFields" title="Description">    <\/div><\/div>')},RemoveDynamicFields:function(n){var t=parseInt(n==undefined?0:n.replace("#ReferenceValueDynamicFields_",""));$(".ReferenceValueDynamicFields").each(function(){var n=$(this).prop("id").replace("ReferenceValueDynamicFields_","");t<n&&$("#txtOrder_"+n).val($("#txtOrder_"+n).val()-1)});$(n).remove();ModalAlert(MODAL_HEADER,MSG_SUCCESS_DELETE_REC)},ValidateDuplicateFields:function(){var n=!0,t=0;return $(".ValueDynamicFields").each(function(){if(this.value!=""){var i=this.value,n=$(this).prop("id").replace("txtValue_","");$("#ReferenceValueDynamicFields_"+n+" input").removeClass("errMessage");$(".ValueDynamicFields").not(this).filter(function(){this.value==i&&($("#ReferenceValueDynamicFields_"+n+" input").addClass("errMessage"),t++)})}}),t>0&&($("#divReferenceErrorMessage").html('<label class="errMessage"><li>'+DUPLICATE_HIGHLIGHTED_FIELDS+"<\/li><\/label><br />"),n=!1),n||$("html, body").animate({scrollTop:0},"slow"),n},LoadReferenceValues:function(){var i=this,n,t;$("#DivReferenceValueDynamicFields").html("");n={handler:"ReferenceValues",RefCode:$("#ddlReferenceCode").val()};t=function(n){var r=function(n,t){i.AddReferenceValueDynamicFields();$("#txtValue_"+t).val(n.Value);$("#txtValue_"+t).attr("readonly",!0);$("#txtDescription_"+t).val(n.Description)},t=1;$(n).each(function(n,i){r(i,t);t++})};objEMSCommonJS.GetAjax(ReferenceValueURL,n,"",t)}};objReferenceJS.Initialize()});
