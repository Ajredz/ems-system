var objEMSCommonJS;$(document).ready(function(){objEMSCommonJS={Initialize:function(){var n=this;n.ElementBinding()},ElementBinding:function(){var n=this;$("body").keyup(function(n){n.keyCode==27&&($("#divModal").css("display")=="block"?$("#divModal").modal("hide"):$(this).find(".modal.fade[style*='display: block'] .close:last").click())})},ValidateBlankFields:function(n,t,i,r){var u=!0,e=$(n+" .required-field"),f=0;return $(n+" "+t).html(""),$(n+" .errMessage").removeClass("errMessage"),e.each(function(){($(this).val()||"").trim()==""&&($(this).addClass("errMessage"),f++)}),f==1?($(n+" .required-field.errMessage:first").focus(),$(n+" "+t).html('<label class="errMessage"><li>'+$(".required-field.errMessage")[0].title+SUFF_REQUIRED+"<\/li><\/label><br />"),r!=null&&r(),u=!1):f>1?($(n+" .required-field.errMessage:first").focus(),$(n+" "+t).html('<label class="errMessage"><li>'+REQ_HIGHLIGHTED_FIELDS+"<\/li><\/label><br />"),u=!1):f<=0&&i!=null&&(u=i()),u||$("html, body").animate({scrollTop:0},"slow"),u},PostAjax:function(n,t,i,r,u,f,e,o,s){var h=n?!1:"application/json;",c=n?!1:!0,l=this;$(u).prop("disabled",!0);Loading(!0);$.ajax({url:t,type:"POST",data:i,async:s==null|s==undefined?!1:s,dataType:"json",headers:{RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()},contentType:h,processData:c,success:function(n){var t,i;if(n.IsSuccess)f!=null&&f(n),o||ModalAlert(MODAL_HEADER,n.Result),$(r).html("");else{if(t="",n.IsListResult==!0)for(i=0;i<n.Result.length;i++)t+=n.Result[i]+"<br />";else t+=n.Result;ModalAlert(MODAL_HEADER,t);e!=null&&e()}$(u).prop("disabled",!1);Loading(!1)},error:function(n){e!=null&&e();Loading(!1);$(u).prop("disabled",!1);ModalAlert(MODAL_HEADER,n.responseText)}})},PostAjaxWithBeforeSend:function(n,t,i,r,u,f,e,o,s,h){var c=n?!1:"application/json;",l=n?!1:!0,a=this;$(u).prop("disabled",!0);Loading(!0);$.ajax({url:t,type:"POST",data:i,async:h==null|h==undefined?!1:h,dataType:"json",headers:{RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()},contentType:c,processData:l,success:function(n){var t,i;if(n.IsSuccess)f!=null&&f(n),s||ModalAlert(MODAL_HEADER,n.Result),$(r).html("");else{if(t="",n.IsListResult==!0)for(i=0;i<n.Result.length;i++)t+=n.Result[i]+"<br />";else t+=n.Result;ModalAlert(MODAL_HEADER,t);e!=null&&e()}$(u).prop("disabled",!1);Loading(!1)},beforeSend:function(){o!=null&&o()},error:function(n){e!=null&&e();Loading(!1);$(u).prop("disabled",!1);ModalAlert(MODAL_HEADER,n.responseText)}})},GetAjax:function(n,t,i,r,u,f){$(i).prop("disabled",!0);Loading(!0);$.ajax({url:n,type:"GET",data:t,async:f==null|f==undefined?!1:f,dataType:"json",contentType:"application/json; charset=utf-8",success:function(n){r!=null&&r(n);$(i).prop("disabled",!1);Loading(!1)},error:function(n){$(i).prop("disabled",!1);u!=null&&u();ModalAlert(MODAL_HEADER,n.responseText);Loading(!1)}})},GetAjaxNoLoading:function(n,t,i,r,u,f){$(i).prop("disabled",!0);$.ajax({url:n,type:"GET",data:t,async:f==null|f==undefined?!1:f,dataType:"json",contentType:"application/json; charset=utf-8",success:function(n){r!=null&&r(n);$(i).prop("disabled",!1)},error:function(n){$(i).prop("disabled",!1);u!=null&&u();ModalAlert(MODAL_HEADER,n.responseText)}})},RemoveFromMultiSelect:function(n,t){$("#"+n+" .selected_"+t).remove();$("#"+n+" .hdn_selected_"+t).remove()},GetMultiSelectList:function(n){var t="",i="";return $("#"+n+" .selected-item").each(function(n,i){t+=i.value+","}),$("#"+n+" .multiselect-item").each(function(n,t){i+=$(t).text().replace(/,/,"{_}")+","}),{value:t.substring(0,t.length-1),text:i.substring(0,i.length-1)}},SetMultiSelectList:function(n,t,i){var r,u=[];r=localStorage[t]!=undefined?localStorage[t].split(","):[];u=localStorage[i]!=undefined?localStorage[i].split(","):[];$(r).each(function(t,i){if(i!=""&&i!=undefined){var r=u[t].replace(/{_}/,",").trim();$("#lbl_"+i).prop("title","delete");$("#"+n).append('<label class="multiselect-item" id="'+i+'" title="delete">'+r+' <span class="glyphicon glyphicon-remove multiselect-glyph-remove" onclick="objEMSCommonJS.RemoveFromMultiSelectEnum(&quot;'+n+"&quot;,&quot;"+i+'&quot;);"><\/span><\/label>');$("#"+n).append('<input type="hidden" class="selected-item" id="hdnSelected_'+i+'" value="'+i+'" />')}})},BindFilterMultiSelectAutoComplete:function(n,t,i,r){var u=i,e=20,f=!1;$("#"+n).focus(function(){u=i;$("#"+n).autocomplete("search",$("#"+n).val()+" ");f=!0;$("#"+n).unbind("click");$("#"+n).click(function(){f||(u=i,$("#"+n).autocomplete("search",$("#"+n).val()+" "));f=!1})});$("#"+n).keyup(function(){u=i});$("#"+n).autocomplete({source:function(n,i){$.ajax({url:t,type:"GET",dataType:"json",data:{term:n.term,topResults:u},success:function(n){n.IsSuccess?i($.map(n.Result,function(n){return{label:n.Description,value:n.ID}})):ModalAlert(MODAL_HEADER,n.Result)},error:function(n){ModalAlert(MODAL_HEADER,n.responseText)}})},select:function(n,t){if(t.item.label!=null){$(this).val("");var i=t.item.value;$("#"+r).focus();$("#"+r).append('<label class="multiselect-item selected_'+i+'" title="delete">'+t.item.label+' <span class="glyphicon glyphicon-remove multiselect-glyph-remove" onclick="objEMSCommonJS.RemoveFromMultiSelect(&quot;'+r+"&quot;,&quot;"+i+'&quot;);"><\/span><\/label>');$("#"+r).append('<input type="hidden" class="selected-item hdn_selected_'+i+'" value="'+i+'" />')}return!1},focus:function(n){n.preventDefault()}});$("#"+n).autocomplete("widget").scroll(function(){$(this).scrollTop()+Math.abs(window.devicePixelRatio*100-100)+$(this).innerHeight()>=$(this)[0].scrollHeight&&(u=u+e,$("#"+n).autocomplete("search",$("#"+n).val()+" "))});$("#"+n).autocomplete("widget").attr("style","max-height: 400px; overflow-y: auto; overflow-x: hidden;")},BindFilterMultiSelectEnum:function(n,t){var i=function(t){$("#"+n).html("");$("#"+n+"Option").html("");$(t.Result).each(function(t,i){$("#"+n+"Option").append('<label class="dropdown-item multiselect-item" id="lbl_'+i.ID+'" title="add">'+i.Description+"<\/label>");$("#"+n+"Option").append('<input type="hidden" value="'+i.ID+'" id="hdn_'+i.ID+'">')});$("#"+n+"Option .dropdown-item").click(function(){var i=$(this).text(),t=$(this).prop("id").replace("lbl_",""),r=$(this).attr("title");r=="add"?($(this).prop("title","delete"),$("#"+n).append('<label class="multiselect-item" title="delete" id="'+t+'">'+i+' <span class="glyphicon glyphicon-remove multiselect-glyph-remove" onclick="objEMSCommonJS.RemoveFromMultiSelectEnum(&quot;'+n+"&quot;,&quot;"+t+'&quot;);"><\/span><\/label>'),$("#"+n).append('<input type="hidden" id="hdnSelected_'+t+'" class="selected-item" value="'+$("#hdn_"+t).val()+'" />')):($("#"+n+" > #"+t).remove(),$("#"+n+" > #hdnSelected_"+t).remove(),$(this).prop("title","add"))})};objEMSCommonJS.GetAjax(t,{},"",i)},BindFilterMultiSelectEnumValueDisplay:function(n,t,i,r){var u=function(t){$("#"+n).html("");$("#"+n+"Option").html("");$(t.Result).each(function(t,u){$("#"+n+"Option").append('<label class="dropdown-item multiselect-item" id="lbl_'+u[i]+'" title="add">'+u[r]+"<\/label>");$("#"+n+"Option").append('<input type="hidden" value="'+u[i]+'" id="hdn_'+u[i]+'">')});$("#"+n+"Option .dropdown-item").click(function(){var i=$(this).text(),t=$(this).prop("id").replace("lbl_",""),r=$(this).attr("title");r=="add"?($(this).prop("title","delete"),$("#"+n).append('<label class="multiselect-item" id="'+t+'" title="delete" >'+i+' <span class="glyphicon glyphicon-remove multiselect-glyph-remove" onclick="objEMSCommonJS.RemoveFromMultiSelectEnum(&quot;'+n+"&quot;,&quot;"+t+'&quot;);"><\/span><\/label>'),$("#"+n).append('<input type="hidden" id="hdnSelected_'+t+'" class="selected-item" value="'+$("#hdn_"+t).val()+'" />')):($("#"+n+" > #"+t).remove(),$("#"+n+" > #hdnSelected_"+t).remove(),$(this).prop("title","add"))})};objEMSCommonJS.GetAjax(t,{},"",u)},BindFilterMultiSelectEnumLocalData:function(n,t){$("#"+n).html("");$("#"+n+"Option").html("");$(t).each(function(t,i){$("#"+n+"Option").append('<label class="dropdown-item multiselect-item" id="lbl_'+i.ID+'" title="add">'+i.Description+"<\/label>");$("#"+n+"Option").append('<input type="hidden" value="'+i.ID+'" id="hdn_'+i.ID+'">')});$("#"+n+"Option .dropdown-item").click(function(){var i=$(this).text(),t=$(this).prop("id").replace("lbl_",""),r=$(this).attr("title");r=="add"?($(this).prop("title","delete"),$("#"+n).append('<label class="multiselect-item" title="delete" id="'+t+'">'+i+' <span class="glyphicon glyphicon-remove multiselect-glyph-remove" onclick="objEMSCommonJS.RemoveFromMultiSelectEnum(&quot;'+n+"&quot;,&quot;"+t+'&quot;);"><\/span><\/label>'),$("#"+n).append('<input type="hidden" id="hdnSelected_'+t+'" class="selected-item" value="'+$("#hdn_"+t).val()+'" />')):($("#"+n+" > #"+t).remove(),$("#"+n+" > #hdnSelected_"+t).remove(),$(this).prop("title","add"))})},RemoveFromMultiSelectEnum:function(n,t){$("#"+n+" #"+t).remove();$("#"+n+" #hdnSelected_"+t).remove();$("#lbl_"+t).prop("title","add")},SetSelectedDropDownDetailedByID:function(n,t,i){$(n+" option").each(function(r){$(this).val()!=""&&JSON.parse($(this).val()).ID==$(t).val()&&($(n+" option:eq("+r+")").prop("selected",!0),i!=null&&i())})},ChangeTab:function(n,t,i){return $((i==undefined?"":i)+" .tablinks").removeClass("active"),$(n).addClass("active"),$((i==undefined?"":i)+" .tabcontent").css({display:"none"}),$((i==undefined?"":i)+" #"+t).css({display:"block"}),!1},PopulateDropDown:function(n,t){$(n).append($("<option/>",{value:"",text:"- Select an Item -"}));$(t).each(function(t,i){$(n).append($("<option/>",{value:i.Value,text:i.Text}))})},DownloadAttachment:function(n,t,i,r){$.ajax({url:n,type:"GET",data:{repoPath:t,serverFile:i},dataType:"json",contentType:"application/json; charset=utf-8",success:function(n){n.IsSuccess?window.location=DownloadFileURL+"&repoPath="+t+"&serverFile="+i+"&sourceFile="+r:ModalAlert(MODAL_HEADER,n.Result);Loading(!1)},error:function(n){ModalAlert(MODAL_HEADER,n.responseText);Loading(!1)}})},UploadModal:function(n,t,i){$("#divModalErrorMessage").html("");$("#fileUpload").removeClass("errMessage");var r='<button type="button" id="btnUploadFile" class="btnBlue formbtn button-width-auto" onclick="objEMSCommonJS.UploadFile(\''+n+"');\">Upload<\/button>";t!=""&&(t+='<button type="button" class="close" data-dismiss="modal">&times;<\/button>');$("#pheader").html(t);i!=""&&(r+='&nbsp <button type="button" id="btnDownloadForm" class="btnBlue formbtn button-width-auto" onclick="objEMSCommonJS.UploadModalDownloadTemplate(\''+i+"');\">Download Template<\/button>");$("#fileUpload").val("");$("#divButtonUploadModal").html(r);$("#divUploadModal").modal("show")},UploadModalDownloadTemplate:function(n){Loading(!0);var t=window.open(n,"_blank");t.onunload=function(){Loading(!1)};t.document.close();t.focus()},UploadSuccessFunction:function(){$("#btnSearch").click()},UploadFile:function(n){var t=$("#fileUpload").val(),i=new FormData,f=$("#fileUpload").get(0),r=f.files,u;if(t.length==0)return $("#divModalErrorMessage").html('<label class="errMessage"><li>Please select a file.<\/li><\/label><br />'),!1;if(u=t.replace(/^.*\./,""),$.inArray(u,["xls","xlsx"])==-1)return $("#divModalErrorMessage").html('<label class="errMessage"><li>Please select only excel files.<\/li><\/label><br />'),!1;$("#divModalErrorMessage").html("");i.append(r[0].name,r[0]);objEMSCommonJS.PostAjax(!0,n,i,"#divModalErrorMessage","",objEMSCommonJS.UploadSuccessFunction,null,null,!0);$("#divUploadModal").modal("hide")},BindAutoComplete:function(n,t,i,r,u,f,e){var o=i,h=20,s=!1;$("#"+n).focus(function(){o=i;$("#"+n).autocomplete("search",$("#"+n).val()+" ");s=!0;$("#"+n).unbind("click");$("#"+n).click(function(){s||(o=i,$("#"+n).autocomplete("search",$("#"+n).val()+" "));s=!1})});$("#"+n).keyup(function(){o=i});$("#"+n).autocomplete({source:function(n,i){$.ajax({url:t,type:"GET",dataType:"json",data:{term:n.term,topResults:o},success:function(n){n.IsSuccess?i($.map(n.Result,function(n){return{label:n[f||"Description"],value:n[u||"Value"]}})):ModalAlert(MODAL_HEADER,n.Result)},error:function(n){ModalAlert(MODAL_HEADER,n.responseText)}})},select:function(n,t){return t.item.label!=null&&$(this).val(t.item.label),!1},change:function(n,t){t.item==null?($("#"+r).val(0),$(this).val("")):($("#"+r).val(t.item.value),$(this).val(t.item.label),e!=null&&e(t.item.value))},focus:function(n){n.preventDefault()}});$("#"+n).autocomplete("widget").scroll(function(){$(this).scrollTop()+$(this).innerHeight()>=$(this)[0].scrollHeight&&(o=o+h,$("#"+n).autocomplete("search",$("#"+n).val()+" "))});$("#"+n).autocomplete("widget").attr("style","max-height: 400px; overflow-y: auto; overflow-x: hidden;")},JQGridIDFormat:function(n){var i=this,t=7;return n=n.toString(),n.length<t?i.JQGridIDFormat("0"+n,t):n},ShowPrintModal:function(n){$("#"+n).show();var i=document.getElementById(n),t=window.open("");t.document.write(i.outerHTML);$("#"+n).hide();t.document.addEventListener("contextmenu",n=>n.preventDefault());t.document.onkeydown=function(n){return n.keyCode==123?!1:n.ctrlKey&&n.shiftKey&&n.keyCode=="I".charCodeAt(0)?!1:n.ctrlKey&&n.shiftKey&&n.keyCode=="C".charCodeAt(0)?!1:n.ctrlKey&&n.shiftKey&&n.keyCode=="J".charCodeAt(0)?!1:n.ctrlKey&&n.keyCode=="U".charCodeAt(0)?!1:void 0};t.document.close();t.focus();t.print()}};objEMSCommonJS.Initialize()});