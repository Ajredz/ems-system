var objApplicantEditJS;$(document).ready(function(){objApplicantEditJS={ID:$("#divApplicantModal #hdnID").val(),Initialize:function(){var n=this;n.ElementBinding();$(".reqField").addClass(".unreqField");$(".reqField").removeClass(".reqField");$("#btnEdit").hide();$("#divApplicantModal #btnSave, #divApplicantModal #btnBack, #btnAddPreloaded, #btnAddActivity").show();$("#divApplicantModal .form-control").attr("readonly",!1);n.GetAttachmentTypeDropDownOptions();objEMSCommonJS.ChangeTab($(".tablinks:nth-child(1)"),"tabPersonalInformation","#divApplicantModal");deletedAttachments=[];personalInfoTabFirstLoad=!1;attachmentTabFirstLoad=!1;appHistoryTabFirstLoad=!1;logActivityTabFirstLoad=!1;$(".Attachment_CreatedDate").attr("readonly",!0);document.getElementById("txtCellphoneNumber").value=$("#txtCellphoneNumber").val().substr(3)},ElementBinding:function(){var n=this;AmountTextChange($("#divApplicantModal #txtExpectedSalary"));AmountOnly($("#divApplicantModal #txtExpectedSalary"));NumberOnly($("#divApplicantModal #txtCellphoneNumber"));$("#dpBirthDate").datetimepicker({useCurrent:!1,format:"MM/DD/YYYY"});$("#dpDateApplied").datetimepicker({useCurrent:!1,format:"MM/DD/YYYY"});$("#ddlMRF").change(function(){if($(this).val()!=""){var n=$("#ddlMRF").val().split(",");objApplicantViewJS.WorkflowTransactionJQGrid({WorkflowID:parseInt(n[1]),MRFApplicantID:parseInt(n[0])})}else $("#tblApplicantWorkflowTransactionList").jqGrid("GridUnload"),$("#tblApplicantWorkflowTransactionList").jqGrid("GridDestroy")});$("#btnAddAttachmentFields").click(function(){var i=$("#DivUploadAttachmentDynamicFields .required-field"),t=!0;i.each(function(){if($(this).val()=="")return $(this).focus(),t=!1,!1});t&&n.AddAttachmentDynamicFields()});$("#ddlPSGCRegion").change(function(){$("#ddlPSGCRegion").val()!=""&&(GenerateDropdownValues(GetCityDropDownByRegionURL+"&RegionID="+$("#ddlPSGCRegion").val(),"ddlPSGCCity","Value","Text","","",!1),$("input[name='Applicant.PersonalInformation.PSGCRegion']").val($("#ddlPSGCRegion").val()))});$("#ddlPSGCCity").change(function(){$("#ddlPSGCCity").val()!=""&&$("input[name='Applicant.PersonalInformation.PSGCCity']").val($("#ddlPSGCCity").val())});$("#txtEmail").on("keyup",function(){return $("#divApplicantErrorMessage").html(""),ValidEmail($("#txtEmail"))||($("#txtEmail").addClass("errMessage"),$("#txtEmail").focus(),$("#divApplicantErrorMessage").append('<label class="errMessage"><li>Email Address is invalid<\/li><\/label><br />')),!1});$("#txtCellphoneNumber").on("keyup",function(){return $("#divApplicantErrorMessage").html(""),validMobileNo($("#txtCellphoneNumber"))||($("#txtCellphoneNumber").addClass("errMessage"),$("#txtCellphoneNumber").focus(),$("#divApplicantErrorMessage").append('<label class="errMessage"><li>Cellphone Number is invalid<\/li><\/label><br />')),!1});$("#btnAddApplicationSource").click(function(){var n=function(){$("#divReferenceModal .close").click(function(){GenerateDropdownValues(GetApplicationSourceURL,"ddlApplicationSource","Value","Description","","",!1)})};LoadPartialSuccessFunction(AddReferenceURL,"divReferenceBodyModal",n);$("#divReferenceModal #hdnReferenceCode").val("APPLICATION_SOURCE");$("#divReferenceModal #hdnReferenceField").val("btnAddApplicationSource");$("#divReferenceModal").modal("show")});$("#lnkType").click(function(){var n=function(){$("#divReferenceModal .close").unbind();$("#divReferenceModal .close").click(function(){var n=$(".AttachmentDynamicFields:last").prop("id"),t=parseInt(n==undefined?0:n.replace("AttachmentDynamicFields_",""));GenerateDropdownValues(AttachmentTypeDropDown,"ddlType_"+t,"Value","Description","","",!1)})};LoadPartialSuccessFunction(AddReferenceURL,"divReferenceBodyModal",n);$("#divReferenceModal #hdnReferenceCode").val("ATTACHMENT_TYPE");$("#divReferenceModal #hdnReferenceField").val("lnkType");$("#divReferenceModal").modal("show")});$("#btnAddCourse").click(function(){var n=function(){$("#divReferenceModal .close").click(function(){GenerateDropdownValues(CourseDropDown,"ddlCourse","Value","Description","","",!1)})};LoadPartialSuccessFunction(AddReferenceURL,"divReferenceBodyModal",n);$("#divReferenceModal #hdnReferenceCode").val("COURSE");$("#divReferenceModal #hdnReferenceField").val("btnAddCourse");$("#divReferenceModal").modal("show")});$("#divApplicantModal #btnSave").click(function(){var n=function(){return ValidEmail($("#txtEmail"))?validMobileNo($("#txtCellphoneNumber"))?$(".AttachmentDynamicFields").length<=0?(objEMSCommonJS.ChangeTab($(".tablinks:nth-child(2)"),"tabAttachment"),$("#divApplicantErrorMessage").append('<label class="errMessage"><li>Attachment'+SUFF_REQUIRED+"<\/li><\/label><br />"),!1):!0:($("#txtCellphoneNumber").addClass("errMessage"),$("#txtCellphoneNumber").focus(),$("#divApplicantErrorMessage").append('<label class="errMessage"><li>Cellphone Number is invalid<\/li><\/label><br />'),!1):($("#txtEmail").addClass("errMessage"),$("#txtEmail").focus(),$("#divApplicantErrorMessage").append('<label class="errMessage"><li>Email Address is invalid<\/li><\/label><br />'),!1)};objEMSCommonJS.ValidateBlankFields("#frmApplicant","#divApplicantErrorMessage",n)?ModalConfirmation(MODAL_HEADER,MSG_CONFIRM,"objEMSCommonJS.PostAjax(true                         , ApplicantEditPostURL                         ,  objApplicantEditJS.GetFormData()                         , '#divApplicantErrorMessage'                         , '#divApplicantModal #btnSave'                         , objApplicantEditJS.EditSuccessFunction); ","function"):$("#tabPersonalInformation .errMessage").length>0&&$("#tabPersonalInformation .errMessage").length==$("#divApplicantModal .errMessage").length-$("#divApplicantErrorMessage .errMessage").length?objEMSCommonJS.ChangeTab($(".tablinks:nth-child(1)"),"tabPersonalInformation"):$("#tabAttachment .errMessage").length>0&&$("#tabAttachment .errMessage").length==$("#divApplicantModal .errMessage").length-$("#divApplicantErrorMessage .errMessage").length&&objEMSCommonJS.ChangeTab($(".tablinks:nth-child(2)"),"tabAttachment")});$("#txtReferredByUserIDDescription").autocomplete({source:function(n,t){$.ajax({url:ReferredByAutoComplete,type:"GET",dataType:"json",data:{Term:$("#txtReferredByUserIDDescription").val(),TopResults:20},success:function(n){n.IsSuccess?t($.map(n.Result,function(n){return{label:n.Description,value:n.ID}})):ModalAlert(MODAL_HEADER,n.Result)},error:function(n){ModalAlert(MODAL_HEADER,n.responseText)}})},select:function(n,t){return t.item.label!=null,!1},change:function(n,t){t.item==null?($("#hdnReferredByUserID").val(0),$(this).val("")):($("#hdnReferredByUserID").val(t.item.value),$(this).val(t.item.label))},focus:function(n,t){$(this).val(t.item.label);n.preventDefault()}});$("#btnDelete").click(function(){ModalConfirmation(MODAL_HEADER,MSG_CONFIRM_DELETE_SINGLE,"objEMSCommonJS.PostAjax(false                     , ApplicantDeleteURL + '?ID=' + objApplicantEditJS.ID                     , {}                     , '#divApplicantErrorMessage'                     , '#btnDelete'                     , objApplicantEditJS.DeleteSuccessFunction);","function")});$("#divApplicantModal #btnBack").click(function(){LoadPartial(ApplicantViewURL+"?ID="+objApplicantEditJS.ID,"divApplicantBodyModal")});$(".tablinks").find("span:contains('Application History')").parent("button").click(function(){if(!appHistoryTabFirstLoad){var n=[],t=function(t){$(t.Result).each(function(t,i){n.push({Value:i.Value,Text:i.Text})});objEMSCommonJS.PopulateDropDown("#ddlMRF",n);$("#ddlMRF option").filter(function(){return $(this).text()==$("#hdnMRFTransactionID").val()}).prop("selected",!0);$("#ddlMRF").change()};objEMSCommonJS.GetAjax(MRFIDDropdownURL+"&ApplicantID="+$("#divApplicantModal #hdnID").val(),{},"",t);appHistoryTabFirstLoad=!0}});$(".tablinks").find("span:contains('Log Activity Checklist')").parent("button").click(function(){if(!logActivityTabFirstLoad){var n=function(){$("#divApplicantModal #tabLogActivity #btnAddPreloaded,                             #divApplicantModal #tabLogActivity #btnAddActivity,                               #divApplicantModal #tabLogActivity #btnBatchAssign").show()};return LoadPartialSuccessFunction(ApplicantLogActivityURL,"tabLogActivity",n),logActivityTabFirstLoad=!0,!1}})},DeleteAttachmentFunction:function(n){deletedAttachments.push(n)},DeleteSuccessFunction:function(){$("#btnSearch").click();$("#divApplicantModal").modal("hide")},EditSuccessFunction:function(){$("#btnSearch").click();$("#divApplicantModal #btnBack").click()},GetFormData:function(){$(".Attachment_File").each(function(n){var t=parseInt(n)+parseInt($("#DivDownloadAttachmentDynamicFields .AttachmentDynamicFields").length);$(this).prop("name","Applicant.Attachments["+t+"].File")});$(".Attachment_Type").each(function(n){$(this).prop("name","Applicant.Attachments["+n+"].AttachmentType")});$(".Attachment_Remarks").each(function(n){$(this).prop("name","Applicant.Attachments["+n+"].Remarks")});$(".Attachment_SourceFile").each(function(n){$(this).prop("name","Applicant.Attachments["+n+"].SourceFile")});$(".Attachment_ServerFile").each(function(n){$(this).prop("name","Applicant.Attachments["+n+"].ServerFile")});var n=new FormData($("#frmApplicant").get(0));return $(".Attachment_Type").each(function(t){n.append("Applicant.Attachments["+t+"].ApplicantID",$("#divApplicantModal #hdnID").val())}),$(deletedAttachments).each(function(t,i){n.append("Applicant.DeletedAttachments["+t+"].ServerFile",i)}),n.append("Applicant.PersonalInformation.CellphoneNumber","+63"+$("#txtCellphoneNumber").val()),n},AddAttachmentDynamicFields:function(){var i=this,t=$(".AttachmentDynamicFields:last").prop("id"),n=parseInt(t==undefined?0:t.replace("AttachmentDynamicFields_",""))+1;$("#DivUploadAttachmentDynamicFields").append('<div class="form-group form-fields AttachmentDynamicFields" id="AttachmentDynamicFields_'+n+'">    <div class="col-md-2 no-padding">        <select id="ddlType_'+n+'" class= "form-control required-field Attachment_Type" title="Attachment Type"><\/select >    <\/div>    <div class="col-md-3-5 no-padding">        <input id="txtRemarks_'+n+'" maxlength="255" class="form-control Attachment_Remarks" title="Remarks">    <\/div>    <div class="col-md-3 no-padding">        <input type="file" id="fileAttachment_'+n+'" class="form-control required-field Attachment_File" title="Attachment" accept=".pdf,.doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document">    <\/div>    <div class="col-md-2-5 no-padding">    <\/div>    <div class="col-md-0-5 no-padding">        <span class="btn-glyph-dynamic glyphicon glyphicon-trash" onclick="ModalConfirmation(MODAL_HEADER, MSG_CONFIRM_DELETE_SINGLE, &quot;objApplicantListJS.RemoveDynamicFields(\'#AttachmentDynamicFields_'+n+"')&quot;, &quot;function&quot;);\"><\/span>    <\/div><\/div>");objEMSCommonJS.PopulateDropDown("#ddlType_"+n,AttachmentTypeDropDownOptions)},GetAttachmentTypeDropDownOptions:function(){var t=this,n=function(n){$(n.Result).each(function(n,t){AttachmentTypeDropDownOptions.push({Value:t.Value,Text:t.Description})})};objEMSCommonJS.GetAjax(AttachmentTypeDropDown,{},"",n)},WorkflowTransactionJQGrid:function(n){var t=this;Loading(!0);$("#tblApplicantWorkflowTransactionList").jqGrid("GridUnload");$("#tblApplicantWorkflowTransactionList").jqGrid("GridDestroy");$("#tblApplicantWorkflowTransactionList").jqGrid({url:WorkflowTransactionURL,postData:n,sortname:"",sortorder:"",selrow:"",pageNumber:1,rowNum:1e4,datatype:"json",mtype:"GET",colNames:["","Order","Step","Status","Date Scheduled","Date Completed","Timestamp","Remarks"],colModel:[{name:"",hidden:!0},{name:"Order",index:"Type",align:"left",sortable:!1,hidden:!0},{name:"Step",index:"Title",align:"left",sortable:!1},{name:"Status",index:"Status",align:"left",sortable:!1},{name:"DateScheduled",index:"DateScheduled",align:"center",sortable:!1},{name:"DateCompleted",index:"DateCompleted",align:"center",sortable:!1},{name:"Timestamp",index:"Timestamp",align:"center",sortable:!1},{name:"Remarks",index:"Remarks",align:"left",sortable:!1}],rowList:SetRowList(),loadonce:!1,viewrecords:!0,jsonReader:{root:"rows",page:"page",total:"total",records:"records",repeatitems:!1},emptyrecords:"No records to display",multiselect:!1,rowNumbers:!0,width:"100%",height:"100%",sortable:!0,loadComplete:function(n){if(Loading(!1),n.IsSuccess!=undefined&&(n.IsSuccess||($("#divErrorMessage").html(""),ModalAlert(MODAL_HEADER,n.Result))),n.rows!=null){if(n.rows.length>0)for(var t=0;t<n.rows.length;t++);AutoSizeColumnJQGrid("tblApplicantWorkflowTransactionList",n)}},loadError:function(n){ModalAlert(MODAL_HEADER,n.responseText);Loading(!1)}})}};objApplicantEditJS.Initialize()});
