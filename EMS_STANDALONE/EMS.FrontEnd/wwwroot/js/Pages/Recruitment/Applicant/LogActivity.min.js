var objLogActivityJS;$(document).ready(function(){objLogActivityJS={IsViewMode:!1,Initialize:function(){var n=this,t;GenerateDropdownValues(LogActivityPreloadedDropDownURL,"ddlPreloaded","Value","Text","","",!1);$("#tblPreloadedLogActivityItemsList").jqGrid("GridUnload");$("#tblPreloadedLogActivityItemsList").jqGrid("GridDestroy");$("#tblLogActivityList").jqGrid("GridUnload");$("#tblLogActivityList").jqGrid("GridDestroy");n.ElementBinding();t={ApplicantID:$("#divApplicantModal #hdnID").val(),TypeDelimited:localStorage.ApplicantLogActivityListType,Title:localStorage.ApplicantLogActivityListTitle,Description:localStorage.ApplicantLogActivityListDescription,CurrentStatusDelimited:localStorage.ApplicantLogActivityListCurrentStatus,CurrentTimestampFrom:localStorage.ApplicantLogActivityListCurrentTimestampFrom,CurrentTimestampTo:localStorage.ApplicantLogActivityListCurrentTimestampTo,AssignedByDelimited:localStorage.ApplicantLogActivityListAssignedBy,AssignedToDelimited:localStorage.ApplicantLogActivityListAssignedTo};n.LoadLogActivityJQGrid(t);n.GetLocalStorage()},ElementBinding:function(){var n=this;$("#btnAddPreloaded").unbind("click");$("#btnAddPreloaded").click(function(){$("#divLogActivityAddPreloadedModal").modal("show")});$("#btnSavePreloaded").unbind("click");$("#btnSavePreloaded").click(function(){$(".errMessage").removeClass("errMessage");$("#divLogActivityAddPreloadedErrorMessage").html("");$("#ddlPreloaded").val()!=""?ModalConfirmation(MODAL_HEADER,MSG_CONFIRM_PROCEED,"objEMSCommonJS.PostAjax(true                         , AddPreLoadedActivitiesURL + "+("'&ApplicantID="+$("#divApplicantModal #hdnID").val()+"&LogActivityPreloadedID="+$("#ddlPreloaded").val()+"'")+"                         ,  { }                         , '#divLogActivityAddPreloadedErrorMessage'                         , '#divLogActivityAddPreloadedModal #btnAddPreloaded'                         , objLogActivityJS.AddPreloadedSuccessFunction); ","function"):($("#ddlPreloaded").addClass("errMessage"),$("#ddlPreloaded").focus(),$("#divLogActivityAddPreloadedErrorMessage").append('<label class="errMessage"><li>'+REQ_HIGHLIGHTED_FIELDS+"<\/li><\/label><br />"))});$("#ddlPreloaded").unbind("change");$("#ddlPreloaded").change(function(){objLogActivityJS.LoadPreloadedLogActivityItemsJQGrid({LogActivityPreloadedID:$(this).val()})});$("#btnAddActivity").unbind("click");$("#btnAddActivity").click(function(){LoadPartial(AddLogActivityURL,"divLogActivityBodyModal");$("#divLogActivityModal").modal("show")});$("#btnBatchAssign").click(function(){$("#divApplicantLogActivityErrorMessage").hide();$("#divApplicantLogActivityErrorMessage").html("");$("#tblLogActivityList").jqGrid("getGridParam","selarrrow").length==0?($("#divApplicantLogActivityErrorMessage").show(),$("#divApplicantLogActivityErrorMessage").html('<label class="errMessage"><li>'+PREF_SELECT_ONE+"activity.<\/li><\/label><br />")):($("#divAssignedUserModal").modal("show"),$("#divAssignedUserModal #txtBatchAssignedUser").val(""))});$("#divAssignedUserModal #btnAssignedUserSave").click(function(){$("#txtBatchAssignedUser").val()!=""?ModalConfirmation(MODAL_HEADER,MSG_CONFIRM,"objEMSCommonJS.PostAjax(true                         , ApplicantUpdateAssignedUserURL                         , objLogActivityJS.GetFormData()                         , ''                         , '#divAssignedUserModal #btnAssignedUserSave'                         , objLogActivityJS.AddSuccessFunction);","function"):($("#txtBatchAssignedUser").addClass("errMessage"),$("#txtBatchAssignedUser").focus())});$("#divAssignedUserModal .close").click(function(){$("#divAssignedUserModal #txtBatchAssignedUser").val("")});objEMSCommonJS.BindAutoComplete("divAssignedUserModal #txtBatchAssignedUser",AssignedUserAutoComplete,20,"divAssignedUserModal #hdnBatchAssignedUserID","ID","Description");$("#tabLogActivity #txtFilterActivityCurrentTimestampFrom, #tabLogActivity #txtFilterActivityCurrentTimestampTo").datetimepicker({useCurrent:!1,format:"MM/DD/YYYY"});objEMSCommonJS.BindFilterMultiSelectEnumValueDisplay("tabLogActivity #multiSelectedActivityType",ApplicantLogActivityGetTypeURL,"Value","Description");objEMSCommonJS.BindFilterMultiSelectEnumValueDisplay("tabLogActivity #multiSelectedActivityCurrentStatus",ApplicantLogActivityGetCurrentStatusURL,"Value","Description");objEMSCommonJS.BindFilterMultiSelectAutoComplete("tabLogActivity #txtFilterActivityAssignedBy",AssignedUserAutoComplete,20,"multiSelectedActivityAssignedBy");objEMSCommonJS.BindFilterMultiSelectAutoComplete("tabLogActivity #txtFilterActivityAssignedTo",AssignedUserAutoComplete,20,"multiSelectedActivityAssignedTo");$("#tabLogActivity #btnSearch").click(function(){var t={ApplicantID:$("#divApplicantModal #hdnID").val(),TypeDelimited:objEMSCommonJS.GetMultiSelectList("tabLogActivity #multiSelectedActivityType").value,Title:$("#tabLogActivity #txtFilterActivityTitle").val(),Description:$("#tabLogActivity #txtFilterActivityDescription").val(),CurrentStatusDelimited:objEMSCommonJS.GetMultiSelectList("tabLogActivity #multiSelectedActivityCurrentStatus").value,CurrentTimestampFrom:$("#tabLogActivity #txtFilterActivityCurrentTimestampFrom").val(),CurrentTimestampTo:$("#tabLogActivity #txtFilterActivityCurrentTimestampTo").val(),AssignedByDelimited:objEMSCommonJS.GetMultiSelectList("tabLogActivity #multiSelectedActivityAssignedBy").value,AssignedToDelimited:objEMSCommonJS.GetMultiSelectList("tabLogActivity #multiSelectedActivityAssignedTo").value};n.SetLocalStorage();ResetJQGridState("tblLogActivityList");n.LoadLogActivityJQGrid(t);$("#divApplicantLogActivityErrorMessage").html("")});$("#tabLogActivity #btnReset").click(function(){$("#tabLogActivity div.filterFields input[type='search']").val("");$("#tabLogActivity div.filterFields select").val("");$("#tabLogActivity div.filterFields input[type='checkbox']").prop("checked",!0);$("#tabLogActivity #multiSelectedActivityType").html("");$("#tabLogActivity #multiSelectedActivityTypeOption label, #tabLogActivity #multiSelectedActivityTypeOption input").prop("title","add");$("#tabLogActivity #multiSelectedActivityCurrentStatus").html("");$("#tabLogActivity #multiSelectedActivityCurrentStatusOption label, #tabLogActivity #multiSelectedActivityCurrentStatusOption input").prop("title","add");$("#tabLogActivity #multiSelectedActivityAssignedBy").html("");$("#tabLogActivity #multiSelectedActivityAssignedByOption label, #tabLogActivity #multiSelectedActivityAssignedByOption input").prop("title","add");$("#tabLogActivity #multiSelectedActivityAssignedTo").html("");$("#tabLogActivity #multiSelectedActivityAssignedToOption label, #tabLogActivity #multiSelectedActivityAssignedToOption input").prop("title","add");$("#divApplicantLogActivityErrorMessage").html("");$("#tabLogActivity #btnSearch").click()})},GetFormData:function(){var n=new FormData($("#frmApplicantLogActivityBatchAssign").get(0));return n.append("AssignedUser.AssignedUserID",$("#divAssignedUserModal #hdnBatchAssignedUserID").val()),$($("#tblLogActivityList").jqGrid("getGridParam","selarrrow")).each(function(t,i){n.append("AssignedUser.LogActivityIDs["+t+"]",i)}),n},AddSuccessFunction:function(){$("#divAssignedUserModal").modal("hide");objLogActivityJS.LoadLogActivityJQGrid({ApplicantID:$("#divApplicantModal #hdnID").val()})},LoadLogActivityJQGrid:function(n){var r=this,t,i;Loading(!0);t=localStorage.getItem("tblLogActivityList")==""?"":$.parseJSON(localStorage.getItem("tblLogActivityList"));i=function(){var n=$("#tabLogActivity .jqgfirstrow").height();$("#tabLogActivity .jqgfirstrow td .filterFields").each(function(){$(this).appendTo("#tabLogActivity #filterFieldsContainer")});$("#tabLogActivity .jqgfirstrow").css({height:n+"px"});$("#tabLogActivity div.filterFields").unbind("keyup");$("#tabLogActivity div.filterFields").keyup(function(n){n.keyCode=="13"&&$("#tabLogActivity #btnSearch").click()})};i();$("#tblLogActivityList").jqGrid("GridUnload");$("#tblLogActivityList").jqGrid("GridDestroy");$("#tblLogActivityList").jqGrid({url:GetLogActivitiesURL,postData:n,sortname:t==null?"":t.sortname,sortorder:t==null?"":t.sortorder,selrow:t==null?"":t.selrow,pageNumber:t==null?1:t.page,rowNum:t==null?10:t.rowNum,datatype:"json",mtype:"GET",colNames:["","Type","Title","Description","Current Status","Timestamp","Assigned By","Assigned To",""],colModel:[{key:!0,name:"ID",index:"ID",align:"center",sortable:!1,formatter:objLogActivityJS.ViewLink},{name:"Type",index:"Type",align:"left",sortable:!1},{name:"Title",index:"Title",align:"left",sortable:!1},{name:"Description",index:"Description",align:"left",sortable:!1},{name:"CurrentStatus",index:"CurrentStatus",align:"center",sortable:!1},{name:"CurrentTimestamp",index:"CurrentTimestamp",align:"center",sortable:!1},{name:"AssignedBy",index:"AssignedBy",align:"left",sortable:!1},{name:"AssignedTo",index:"AssignedTo",align:"left",sortable:!1},{hidden:!0,name:"IsAssignment",index:"IsAssignment"},],toppager:$("#divApplicantLogActivityPager"),rowList:SetRowList(),loadonce:!1,viewrecords:!0,jsonReader:{root:"rows",page:"page",total:"total",records:"records",repeatitems:!1},emptyrecords:"No records to display",multiselect:!0,rowNumbers:!0,width:"100%",height:"100%",sortable:!0,loadComplete:function(n){if(Loading(!1),n.IsSuccess!=undefined&&(n.IsSuccess||($("#divErrorMessage").html(""),ModalAlert(MODAL_HEADER,n.Result))),n.rows!=null){if(n.rows.length>0)for(var t=0;t<n.rows.length;t++)n.rows[t].IsAssignment==!1&&$("#jqg_tblLogActivityList_"+n.rows[t].ID).attr("disabled",!0);$("#tabLogActivity #filterFieldsContainer .filterFields").each(function(n){$(this).appendTo("#tabLogActivity .jqgfirstrow td:nth-child("+(n+2)+")")});$("#tabLogActivity #tblLogActivityList .jqgrid-id-link").click(function(){$("#divLogActivityModal").modal("show")})}objLogActivityJS.IsViewMode==!0&&($("#tblLogActivityList").jqGrid("hideCol","cb"),$("#tblLogActivityList").jqGrid("hideCol","ID"));localStorage.ApplicantLogActivityListFilterOption!=undefined&&$("#tabLogActivity #chkEmpLogActivityFilter").prop("checked",JSON.parse(localStorage.ApplicantLogActivityListFilterOption));objLogActivityJS.ShowHideFilter();$("#tabLogActivity #chkEmpLogActivityFilter").on("change",function(){objLogActivityJS.ShowHideFilter();localStorage.ApplicantLogActivityListFilterOption=$("#chkEmpLogActivityFilter").is(":checked")});$("#tabLogActivity .ui-jqgrid-bdiv").css({"min-height":"400px"})},onSelectAll:function(n,t){if(t){var i=$("tr.jqgrow > td > input.cbox:disabled",$(this));i.removeAttr("checked");$(this)[0].p.selarrrow=$(this).find("tr.jqgrow:has(td > input.cbox:checked)").map(function(){return this.id}).get()}},beforeSelectRow:function(n){var t=$("tr#"+n+".jqgrow > td > input.cbox:disabled",$(this));return t.length==0?!0:!1},loadError:function(n){ModalAlert(MODAL_HEADER,n.responseText);Loading(!1)},beforeRequest:function(){GetJQGridState("tblLogActivityList");i()}}).navGrid("#divApplicantLogActivityPager",{edit:!1,add:!1,del:!1,search:!1,refresh:!1});jQuery("#tabLogActivity .ui-pg-selbox").closest("select").before('<label class="ui-row-label">Show<\/label>');jQuery("#tabLogActivity .ui-row-label").closest("label").before('<label class="ui-row-label" id="lblFilter">Show Filter<\/label>');jQuery("#tabLogActivity #lblFilter").after('<input type="checkbox" id="chkEmpLogActivityFilter" style="margin-right:15px; margin-top: 5px;"><\/div>')},SetLocalStorage:function(){localStorage.ApplicantLogActivityListType=objEMSCommonJS.GetMultiSelectList("tabLogActivity #multiSelectedActivityType").value;localStorage.ApplicantLogActivityListTypeText=objEMSCommonJS.GetMultiSelectList("tabLogActivity #multiSelectedActivityType").text;localStorage.ApplicantLogActivityListSubType=objEMSCommonJS.GetMultiSelectList("tabLogActivity #multiSelectedSubType").value;localStorage.ApplicantLogActivityListSubTypeText=objEMSCommonJS.GetMultiSelectList("tabLogActivity #multiSelectedSubType").text;localStorage.ApplicantLogActivityListTitle=$("#tabLogActivity #txtFilterActivityTitle").val();localStorage.ApplicantLogActivityListDescription=$("#tabLogActivity #txtFilterActivityDescription").val();localStorage.ApplicantLogActivityListCurrentStatus=objEMSCommonJS.GetMultiSelectList("tabLogActivity #multiSelectedActivityCurrentStatus").value;localStorage.ApplicantLogActivityListCurrentStatusText=objEMSCommonJS.GetMultiSelectList("tabLogActivity #multiSelectedActivityCurrentStatus").text;localStorage.ApplicantLogActivityListCurrentTimestampFrom=$("#tabLogActivity #txtFilterActivityCurrentTimestampFrom").val();localStorage.ApplicantLogActivityListCurrentTimestampTo=$("#tabLogActivity #txtFilterActivityCurrentTimestampTo").val();localStorage.ApplicantLogActivityListAssignedBy=objEMSCommonJS.GetMultiSelectList("tabLogActivity #multiSelectedActivityAssignedBy").value;localStorage.ApplicantLogActivityListAssignedByText=objEMSCommonJS.GetMultiSelectList("tabLogActivity #multiSelectedActivityAssignedBy").text;localStorage.ApplicantLogActivityListAssignedTo=objEMSCommonJS.GetMultiSelectList("tabLogActivity #multiSelectedActivityAssignedTo").value;localStorage.ApplicantLogActivityListAssignedToText=objEMSCommonJS.GetMultiSelectList("tabLogActivity #multiSelectedActivityAssignedTo").text;localStorage.ApplicantLogActivityListRemarks=$("#tabLogActivity #txtFilterRemarks").val()},GetLocalStorage:function(){objEMSCommonJS.SetMultiSelectList("tabLogActivity #multiSelectedActivityType","ApplicantLogActivityListType","ApplicantLogActivityListTypeText");objEMSCommonJS.SetMultiSelectList("#tabLogActivity #multiSelectedSubType","ApplicantLogActivityListSubType","ApplicantLogActivityListSubTypeText");$("#tabLogActivity #txtFilterActivityTitle").val(localStorage.ApplicantLogActivityListTitle);$("#tabLogActivity #txtFilterActivityDescription").val(localStorage.ApplicantLogActivityListDescription);objEMSCommonJS.SetMultiSelectList("tabLogActivity #multiSelectedActivityCurrentStatus","ApplicantLogActivityListCurrentStatus","ApplicantLogActivityListCurrentStatusText");objEMSCommonJS.SetMultiSelectList("tabLogActivity #multiSelectedActivityAssignedBy","ApplicantLogActivityListAssignedBy","ApplicantLogActivityListAssignedByText");$("#tabLogActivity #txtFilterActivityCurrentTimestampFrom").val(localStorage.ApplicantLogActivityListCurrentTimestampFrom);$("#tabLogActivity #txtFilterActivityCurrentTimestampTo").val(localStorage.ApplicantLogActivityListCurrentTimestampTo);objEMSCommonJS.SetMultiSelectList("tabLogActivity #multiSelectedActivityAssignedTo","ApplicantLogActivityListAssignedTo","ApplicantLogActivityListAssignedToText");$("#tabLogActivity #txtFilterRemarks").val(localStorage.ApplicantLogActivityListRemarks)},ShowHideFilter:function(){$("#tabLogActivity #chkEmpLogActivityFilter").is(":checked")?$("#tabLogActivity .jqgfirstrow .filterFields").show():$("#chkEmpLogActivityFilter").is(":not(:checked)")&&$("#tabLogActivity .jqgfirstrow .filterFields").hide()},LoadPreloadedLogActivityItemsJQGrid:function(n){var t=this;Loading(!0);$("#tblPreloadedLogActivityItemsList").jqGrid("GridUnload");$("#tblPreloadedLogActivityItemsList").jqGrid("GridDestroy");$("#tblPreloadedLogActivityItemsList").jqGrid({url:LogActivityByPreloadedIDURL,postData:n,sortname:"",sortorder:"",selrow:"",pageNumber:1,rowNum:10,datatype:"json",mtype:"GET",colNames:["","Type","Title","Description"],colModel:[{name:"",hidden:!0},{name:"Type",index:"Type",align:"center",sortable:!1},{name:"Title",index:"Title",align:"center",sortable:!1},{name:"Description",index:"Description",align:"center",sortable:!1},],toppager:$("#divApplicantLogActivityPager"),rowList:SetRowList(),loadonce:!0,viewrecords:!0,jsonReader:{root:"rows",page:"page",total:"total",records:"records",repeatitems:!1},emptyrecords:"No records to display",multiselect:!1,rowNumbers:!0,width:"100%",height:"100%",sortable:!0,loadComplete:function(n){if(Loading(!1),n.IsSuccess!=undefined&&(n.IsSuccess||($("#divErrorMessage").html(""),ModalAlert(MODAL_HEADER,n.Result))),n.rows!=null){if(n.rows.length>0)for(var t=0;t<n.rows.length;t++);AutoSizeColumnJQGrid("tblPreloadedLogActivityItemsList",n)}},loadError:function(n){ModalAlert(MODAL_HEADER,n.responseText);Loading(!1)}})},ViewLink:function(n,t,i){return"<a href=\"\" class='activity-id-link' onclick=\"return objLogActivityJS.ViewUpdateStatusModal('"+UpdateLogActivityURL+"?ApplicantLogActivityID="+i.ID+"');\">"+objEMSCommonJS.JQGridIDFormat(i.ID)+"<\/a>"},AddPreloadedSuccessFunction:function(){$("#divLogActivityAddPreloadedModal").modal("hide");objLogActivityJS.LoadLogActivityJQGrid({ApplicantID:$("#divApplicantModal #hdnID").val()})},ViewUpdateStatusModal:function(n){return $("#divLogActivityModal").modal("show"),LoadPartial(n,"divLogActivityBodyModal"),!1}};objLogActivityJS.Initialize()});
